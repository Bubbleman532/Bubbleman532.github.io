{"version":3,"sources":["webpack:///./src/main.js","webpack:///./src/TMDocumentController.js","webpack:///./src/TMSimulator.js","webpack:///./src/DocumentMenu.js","webpack:///./src/TMDocument.js","webpack:///./src/examples.js","webpack:///./src/sharing/format.js","webpack:///^\\.\\/.*\\.yaml$","webpack:///./src/examples/_template.yaml","webpack:///./src/examples/binaryAdd.yaml","webpack:///./src/examples/binaryIncrement.yaml","webpack:///./src/examples/binaryMult.yaml","webpack:///./src/examples/busyBeaver3.yaml","webpack:///./src/examples/busyBeaver4.yaml","webpack:///./src/examples/copy1s.yaml","webpack:///./src/examples/divisibleBy3.yaml","webpack:///./src/examples/divisibleBy3Base10.yaml","webpack:///./src/examples/lengthMult.yaml","webpack:///./src/examples/matchBinaryStrings.yaml","webpack:///./src/examples/matchThreeLengths.yaml","webpack:///./src/examples/palindrome.yaml","webpack:///./src/examples/powersOfTwo.yaml","webpack:///./src/examples/repeat01.yaml","webpack:///./src/examples/unaryMult.yaml","webpack:///external \"jQuery\"","webpack:///./src/sharing/import.js","webpack:///./src/sharing/CheckboxTable.js","webpack:///./src/sharing/FileReaderPromise.js","webpack:///external \"Promise\"","webpack:///./src/sharing/gist.js","webpack:///./src/sharing/import-panel.js","webpack:///./src/sharing/export-panel.js","webpack:///external \"Clipboard\"","webpack:///./src/kbdshortcuts.js"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,+CAA0B;;AAE1B;AACA;AACA;;AAEA,qBAAoB,oCAAoC;;AAExD;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,qEAAoE;AACpE;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH,EAAC;;;AAGD;AACA;AACA;;AAEA;AACA;AACA,wBAAuB,2BAA2B;AAClD;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL,IAAG;AACH;AACA;AACA;AACA;AACA;AACA,yBAAwB;AACxB;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA,IAAG;AACH,EAAC;;;AAGD;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH,EAAC;;;AAGD;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yCAAwC;AACxC;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;;AAEA,wCAAuC;AACvC;AACA;AACA,2CAA0C,aAAa;AACvD;;AAEA;AACA,uBAAsB,aAAa;AACnC;AACA,2CAA0C;AAC1C;AACA;AACA;AACA;;AAEA;AACA,KAAI,2DAA2D;AAC/D,IAAG;AACH;AACA;AACA;AACA;;AAEA,4BAA2B,gBAAgB;AAC3C;AACA;AACA,UAAS;AACT,MAAK;AACL,IAAG;AACH,EAAC;;;AAGD;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2CAA0C,cAAc;AACxD;AACA;AACA;AACA;AACA,EAAC;;AAED;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA,IAAG;AACH,EAAC;;AAED;AACA;AACA;AACA,aAAY,8BAA8B;AAC1C;AACA;AACA;AACA,EAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA,EAAC;;AAED;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAC;;AAED;AACA;AACA;AACA;AACA,EAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,QAAO;AACP;AACA,IAAG;AACH,EAAC;;AAED;AACA;;;;;;;;;;AC/WA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAW,OAAO;AAClB;AACA,YAAW,eAAe;AAC1B,YAAW,eAAe;AAC1B,YAAW,eAAe;AAC1B,YAAW,OAAO;AAClB,YAAW,kBAAkB;AAC7B,YAAW,kBAAkB;AAC7B,YAAW,kBAAkB;AAC7B,YAAW,kBAAkB;AAC7B,YAAW,kBAAkB;AAC7B,YAAW,kBAAkB;AAC7B,YAAW,WAAW;AACtB;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA,QAAO;;AAEP;AACA;AACA,eAAc,WAAW;AACzB;AACA,MAAK;AACL,kBAAiB,iBAAiB;AAClC,kBAAiB,oBAAoB;AACrC,kBAAiB;AACjB,IAAG;AACH;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,0CAAyC,QAAQ,EAAE;AACnD;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,YAAW,QAAQ;AACnB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,iCAAgC,kBAAkB,EAAE,EAAE;;AAEtD;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uCAAsC,gCAAgC;AACtE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAe;AACf;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA,UAAS;AACT;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA,MAAK;AACL,2BAA0B,UAAU,EAAE;AACtC;AACA;;;AAGA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA,IAAG;AACH,qBAAoB,wBAAwB;AAC5C,EAAC;;AAED;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA,EAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA,aAAY,QAAQ;AACpB;AACA;AACA,wBAAuB,2BAA2B;AAClD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA,IAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;;;;;;;;;ACjXA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,YAAW,OAAO;AAClB,YAAW,OAAO;AAClB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,6BAA4B;AAC5B,QAAO;AACP;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA,QAAO;AACP;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAe;AACf;AACA;AACA,MAAK;AACL;AACA;AACA;AACA,wCAAuC;AACvC;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA,IAAG;AACH;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA,MAAK;AACL;AACA,IAAG;AACH;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA,EAAC;;AAED;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAU;AACV;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA,IAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qCAAoC,sBAAsB,EAAE;AAC5D;;AAEA;;;;;;;;;;ACjJA;;AAEA;AACA;AACA;AACA;AACA,iEAA6C;;AAE7C;AACA;AACA;AACA;AACA;AACA,YAAW,OAAO;AAClB,YAAW;AACX;AACA,YAAW,MAAM;AACjB,YAAW,OAAO;AAClB,YAAW;AACX;AACA,YAAW,QAAQ;AACnB;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,0CAAyC,aAAa;AACtD,IAAG;;AAEH;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;;AAEA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA,IAAG;AACH;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA,EAAC;;AAED;AACA;;AAEA;AACA,gDAA+C,iBAAiB,EAAE;;AAElE;;AAEA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,yDAAwD,eAAe;AACvE;AACA,4CAA2C,eAAe;AAC1D;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA,+DAA8D,aAAa;AAC3E;;AAEA;;AAEA;AACA,gEAA+D,kBAAkB;AACjF;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mDAAkD,eAAe;AACjE;AACA;AACA;;AAEA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,wBAAuB,UAAU;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,aAAY,OAAO;AACnB,aAAY,QAAQ;AACpB;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,uBAAsB,oBAAoB,EAAE;AAC5C;AACA;AACA,EAAC;;AAED;;;;;;;;;;ACrSA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,YAAW,OAAO;AAClB;AACA;AACA;AACA;AACA;AACA,cAAa,eAAe;AAC5B,cAAa,wBAAwB;AACrC,iBAAgB;AAChB,IAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA0B,oBAAoB,EAAE;AAChD,4BAA2B;AAC3B;AACA;AACA,MAAK;AACL;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,yBAAwB,8BAA8B,EAAE;AACxD,4BAA2B,6BAA6B,EAAE;AAC1D;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA,QAAO;AACP;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA,EAAC;;AAED;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;;AAEA;AACA,mBAAkB;AAClB;;AAEA;;AAEA;AACA;AACA,aAAY,QAAQ;AACpB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,YAAW,SAAS;AACpB;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;;;;;;;;;AC1JA;;AAEA;AACA;;;AAGA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,EAAC;AACD;;;AAGA;AACA,YAAW;AACX;;AAEA;AACA;AACA;;AAEA,8CAA6C,gBAAgB,EAAE;;;AAG/D;AACA;AACA;AACA;AACA;;;;;;;;;;ACnDA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,KAAI,wBAAwB;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,aAAY,WAAW;AACvB,aAAY;AACZ;AACA;AACA;AACA,0BAAyB,kBAAkB,EAAE;AAC7C;AACA;AACA,UAAS;AACT,UAAS;AACT,IAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;;AAEA;AACA;AACA;AACA;AACA,aAAY,OAAO;AACnB,aAAY,OAAO;AACnB,aAAY,cAAc;AAC1B,aAAY,UAAU;AACtB;AACA;AACA;AACA;AACA;AACA,wBAAuB,kCAAkC;AACzD,IAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;;;;;;;;;ACnGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAiC,uDAAuD;AACxF;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;AC7BA,6BAA4B,EAAE,eAAe,IAAI,oBAAoB,QAAQ,kBAAkB,EAAE,IAAI,K;;;;;;;;;ACArG,wxCAAuxC,s+BAAs+B,eAAe,gBAAgB,eAAe,gBAAgB,eAAe,mBAAmB,eAAe,eAAe,eAAe,eAAe,eAAe,eAAe,eAAe,mBAAmB,eAAe,eAAe,eAAe,eAAe,eAAe,eAAe,eAAe,K;;;;;;;;;ACAlkF,2UAA0U,4sBAA4sB,eAAe,cAAc,eAAe,aAAa,eAAe,K;;;;;;;;;ACA9lC,qwCAAowC,utEAAutE,cAAc,eAAe,cAAc,eAAe,cAAc,eAAe,eAAe,mBAAmB,eAAe,eAAe,eAAe,eAAe,cAAc,eAAe,eAAe,mBAAmB,eAAe,eAAe,eAAe,gBAAgB,eAAe,oBAAoB,eAAe,eAAe,eAAe,mBAAmB,eAAe,eAAe,eAAe,eAAe,eAAe,eAAe,eAAe,mBAAmB,eAAe,eAAe,eAAe,eAAe,eAAe,eAAe,eAAe,K;;;;;;;;;ACAplI,0YAAyY,wsBAAwsB,eAAe,gBAAgB,KAAK,4BAA4B,eAAe,gBAAgB,eAAe,4BAA4B,YAAY,gBAAgB,KAAK,eAAe,0iBAA0iB,eAAe,UAAU,eAAe,UAAU,eAAe,UAAU,eAAe,K;;;;;;;;;ACA/4D,ygBAAwgB,44CAA44C,eAAe,UAAU,eAAe,cAAc,eAAe,UAAU,eAAe,UAAU,eAAe,K;;;;;;;;;ACA3gE,8fAA6f,omBAAomB,eAAe,aAAa,eAAe,aAAa,eAAe,aAAa,eAAe,aAAa,eAAe,aAAa,eAAe,K;;;;;;;;;ACA5vC,0XAAyX,mqCAAmqC,eAAe,WAAW,eAAe,WAAW,eAAe,eAAe,eAAe,K;;;;;;;;;ACA7nD,6eAA4e,61BAA61B,eAAe,WAAW,eAAe,WAAW,eAAe,eAAe,eAAe,K;;;;;;;;;ACA16C,87BAA67B,wCAAwC,0CAA0C,mbAAmb,cAAc,eAAe,eAAe,eAAe,eAAe,eAAe,eAAe,eAAe,eAAe,mBAAmB,cAAc,eAAe,eAAe,eAAe,eAAe,eAAe,eAAe,mBAAmB,eAAe,eAAe,eAAe,eAAe,eAAe,K;;;;;;;;;ACAjyD,0tBAAytB,0CAA0C,YAAY,IAAI,GAAG,8ZAA8Z,2MAA2M,eAAe,eAAe,eAAe,2DAA2D,eAAe,eAAe,eAAe,eAAe,kBAAkB,eAAe,kBAAkB,eAAe,kBAAkB,eAAe,kBAAkB,K;;;;;;;;;ACAxpD,2gBAA0gB,4CAA4C,iBAAiB,6tBAA6tB,eAAe,WAAW,eAAe,WAAW,eAAe,eAAe,eAAe,eAAe,eAAe,eAAe,eAAe,K;;;;;;;;;ACAj8C,uvBAAsvB,kBAAkB,kYAAkY,eAAe,eAAe,eAAe,eAAe,eAAe,mBAAmB,eAAe,eAAe,eAAe,eAAe,eAAe,mBAAmB,cAAc,eAAe,eAAe,K;;;;;;;;;ACAl3C,gpBAA+oB,kBAAkB,o1BAAo1B,eAAe,eAAe,eAAe,eAAe,eAAe,mBAAmB,eAAe,eAAe,eAAe,eAAe,eAAe,eAAe,eAAe,K;;;;;;;;;ACA5rD,iyBAAgyB,eAAe,UAAU,eAAe,UAAU,eAAe,UAAU,eAAe,K;;;;;;;;;ACA13B,ycAAwc,qwBAAqwB,eAAe,eAAe,eAAe,eAAe,eAAe,cAAc,eAAe,cAAc,eAAe,kBAAkB,eAAe,eAAe,eAAe,mBAAmB,cAAc,eAAe,cAAc,eAAe,eAAe,K;;;;;;;;;ACA7+C,yB;;;;;;;;;ACAA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,uDAAkC;;;AAGlC;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAa,kEAAkE;AAC/E;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,uBAAsB,oCAAoC;AAC1D;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA,mBAAkB,8BAA8B;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,oBAAmB;AACnB,8CAA6C;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAe;AACf;AACA;AACA,cAAa;AACb,UAAS;AACT;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL,IAAG;AACH;AACA;AACA;AACA;AACA;AACA,MAAK;AACL,IAAG;AACH;AACA;AACA;AACA;AACA;AACA,wBAAuB,wCAAwC,EAAE;AACjE,MAAK;AACL,IAAG;AACH,8CAA6C;AAC7C;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA,IAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAiB;AACjB,mBAAkB;;AAElB;AACA,sBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAsB;AACtB;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAiB;;AAEjB;AACA,2CAA0C;AAC1C;AACA;AACA,MAAK;AACL;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT,QAAO;AACP,sBAAqB;AACrB;AACA;AACA,UAAS;AACT;AACA,UAAS;AACT;AACA;AACA,QAAO;AACP;AACA,IAAG,UAAU,mDAAmD;AAChE;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA,KAAI;AACJ,8EAA6E;AAC7E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA,cAAa,0CAA0C;AACvD;AACA;AACA;AACA,MAAK;AACL,IAAG;AACH;AACA;AACA;AACA,cAAa,kEAAkE;AAC/E;AACA;AACA;AACA,2CAA0C,0BAA0B;AACpE;AACA;AACA,oCAAmC,iCAAiC,EAAE;AACtE;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA;;AAEA,KAAI,0EAA0E;AAC9E;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA,IAAG;AACH;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA,KAAI,qCAAqC;AACzC;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;;AAEA,KAAI,mCAAmC;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,MAAK,iEAAiE;AACtE,KAAI,kEAAkE;AACtE;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAA+B,0CAA0C;AACzE;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA,QAAO;AACP,MAAK;AACL;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA,IAAG;AACH;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;;AAEA,KAAI,iEAAiE;AACrE;;AAEA,KAAI,kEAAkE;AACtE;;AAEA;AACA;AACA;AACA;AACA;;AAEA,MAAK,WAAW;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAW;AACX;AACA,YAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL,IAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,KAAI,iDAAiD;AACrD;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA,0BAAyB,eAAe;AACxC;AACA;AACA;;AAEA;AACA;AACA;;;;;;;;;;ACnhBA;;AAEA;AACA,+CAA0B;;AAE1B,uBAAsB,UAAU;AAChC,uBAAsB,iBAAiB;;AAEvC;AACA;AACA;AACA,YAAW,8BAA8B;AACzC,YAAW,SAAS;AACpB,YAAW,WAAW;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;AACA,YAAW,SAAS;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,YAAW,WAAW;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,wBAAuB,gBAAgB,EAAE;AACzC;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;;;;;;;;;AC9HA;;AAEA;AACA,uDAAkC;;AAElC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA,MAAK;AACL;AACA,YAAW,gBAAgB,EAAE,YAAY;AACzC,MAAK;;AAEL;AACA,IAAG;AACH;;AAEA;;;;;;;;;;ACzBA,0B;;;;;;;;;ACAA;;AAEA;AACA,uDAAkC;;AAElC;AACA;AACA,EAAC;;AAED;AACA,yCAAwC,0CAA0C;AAClF;AACA;AACA;AACA;AACA;AACA,eAAc,mDAAmD;AACjE,MAAK;AACL;AACA,YAAW,aAAa,EAAE,YAAY;AACtC,MAAK;AACL,IAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;;AAEA;AACA;AACA,KAAI,QAAQ,qBAAqB,iBAAiB;AAClD,4CAA2C;AAC3C;AACA,kCAAiC,qBAAqB;AACtD;AACA;AACA;AACA;AACA,kBAAiB,gCAAgC;AACjD;AACA;AACA,IAAG;AACH;;AAEA;AACA;;;;;;;;;;ACpDA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA,KAAI,iEAAiE;AACrE;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;;AAEA;AACA;AACA;AACA;;AAEA;AACA,oCAAmC,eAAe;AAClD,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4CAA2C,uBAAuB;AAClE,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,UAAS,cAAc,iDAAiD;AACxE,sDAAqD;AACrD;AACA;AACA;AACA;AACA,MAAK;AACL,IAAG;AACH;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,cAAa,sCAAsC;AACnD,8CAA6C;AAC7C;AACA;;AAEA;AACA,MAAK,0CAA0C;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA,cAAa,cAAc;AAC3B;AACA;AACA;AACA,QAAO;;AAEP;AACA;AACA;AACA,gBAAe,2CAA2C;AAC1D;AACA;AACA;AACA;AACA,2BAA0B;AAC1B,UAAS;AACT;AACA,mDAAkD;AAClD;AACA,MAAK;AACL;AACA,qDAAoD;AACpD,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,kBAAiB,qBAAqB;AACtC;AACA;AACA,IAAG;AACH,kBAAiB,sBAAsB;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA,IAAG;AACH;AACA;AACA;;AAEA;;;;;;;;;;ACpJA;;AAEA;AACA;AACA;AACA;AACA,+CAA0B;;AAE1B;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA,EAAC;;AAED;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA,IAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;;AAEA;AACA,qCAAoC,sCAAsC;AAC1E;;;AAGA;AACA;AACA;;AAEA;AACA;AACA,aAAY,YAAY;AACxB,aAAY,kBAAkB;AAC9B,aAAY,OAAO;AACnB,aAAY,OAAO;AACnB,aAAY,QAAQ;AACpB;AACA;AACA;AACA;AACA;;AAEA;AACA,cAAa;AACb;AACA;AACA;AACA,8BAA6B;;AAE7B;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA,UAAS;AACT;AACA;AACA;AACA,MAAK;AACL;;AAEA;AACA;AACA,IAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;;AAEA;AACA;AACA;AACA,iCAAgC;AAChC;AACA;;AAEA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA,cAAa,sBAAsB,EAAE,YAAY;AACjD;AACA,oBAAmB,iBAAiB;AACpC;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA,IAAG;AACH;;AAEA;;;;;;;;;;AC9NA,4B;;;;;;;;;ACAA;AACA;AACA;AACA;;AAEA;;AAEA,uBAAsB,UAAU;;AAEhC;AACA;AACA,aAAY,aAAa;AACzB,aAAY,iBAAiB;AAC7B,aAAY,YAAY;AACxB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;;AAGA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,IAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;;AAGA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL,IAAG;AACH;;AAEA;AACA;AACA,MAAK;AACL;AACA,MAAK,gDAAgD;AACrD,MAAK,2CAA2C;AAChD,MAAK;AACL;AACA,MAAK,4CAA4C;AACjD,MAAK,gDAAgD;AACrD,MAAK;AACL;AACA,MAAK,wIAAwI;AAC7I,MAAK,6BAA6B;AAClC,MAAK;AACL;AACA;;;AAGA","file":"main.bundle.js","sourcesContent":["// main entry point for index.html.\r\n// important: make sure to coordinate variables and elements between the HTML and JS\r\n'use strict';\r\n\r\n/* eslint-env browser */\r\nvar TMDocumentController = require('./TMDocumentController'),\r\n    DocumentMenu = require('./DocumentMenu'),\r\n    examples = require('./examples'),\r\n    toDocFragment = require('./util').toDocFragment;\r\nvar ace = require('ace-builds/src-min-noconflict');\r\nvar $ = require('jquery'); // for Bootstrap modal dialog events\r\n\r\n// load up front so going offline doesn't break anything\r\n// (for snippet placeholders, used by \"New blank document\")\r\nace.config.loadModule('ace/ext/language_tools');\r\n\r\nfunction getId(id) { return document.getElementById(id); }\r\n\r\nfunction addAlertPane(type, html) {\r\n  getId('diagram-column').insertAdjacentHTML('afterbegin',\r\n    '<div class=\"alert alert-'+type+' alert-dismissible\" role=\"alert\">' +\r\n    '<button type=\"button\" class=\"close\" data-dismiss=\"alert\" aria-label=\"Close\"><span aria-hidden=\"true\">×</span></button>' +\r\n    html +\r\n    '</div>');\r\n}\r\n\r\n\r\n//////////////////////////\r\n// Compatibility Checks //\r\n//////////////////////////\r\n\r\n(function () {\r\n  // Warn when falling back to RAM-only storage\r\n  // NB. This mainly covers local storage errors and Safari's Private Browsing.\r\n  if (!require('./storage').canUseLocalStorage) {\r\n    addAlertPane('info', '<p>Local storage is unavailable. ' +\r\n      'Your browser could be in Private Browsing mode, or it might not support <a href=\"http://caniuse.com/#feat=namevalue-storage\" target=\"_blank\">local storage</a>.</p>' +\r\n      '<strong>Any changes will be lost after leaving the webpage.</strong>');\r\n  }\r\n\r\n  /*\r\n  Warn for IE 10 and under, which misbehave and lack certain features.\r\n  Examples:\r\n    • IE 9 and under don't support .classList.\r\n    • IE 10's \"storage event is fired even on the originating document where it occurred.\"\r\n      http://caniuse.com/#feat=namevalue-storage\r\n  */\r\n\r\n  // Detect IE 10 and under (http://stackoverflow.com/a/16135889)\r\n  var isIEUnder11 = new Function('/*@cc_on return @_jscript_version; @*/')() < 11;\r\n  if (isIEUnder11) {\r\n    addAlertPane('warning',\r\n      '<p><strong>Your <a href=\"http://whatbrowser.org\" target=\"_blank\">web browser</a> is out of date</strong> and does not support some features used by this program.<br>' +\r\n      '<em>The page may not work correctly, and data may be lost.</em></p>' +\r\n      'Please update your browser, or use another browser such as <a href=\"http://www.google.com/chrome/browser/\" target=\"_blank\">Chrome</a> or <a href=\"http://getfirefox.com\" target=\"_blank\">Firefox</a>.');\r\n  }\r\n\r\n  // Warn about iOS local storage volatility\r\n  $(function () {\r\n    // Detect iOS (http://stackoverflow.com/a/9039885)\r\n    var isIOS = /iPad|iPhone|iPod/.test(navigator.userAgent) && !window.MSStream;\r\n    if (isIOS) {\r\n      getId('misc-tips-list').insertAdjacentHTML('afterbegin',\r\n        '<li><strong class=\"text-warning\">Important note for iOS</strong>: ' +\r\n        'iOS saves browser local storage in the cache folder, which is <strong>not backed up</strong>, and is ' +\r\n        '<q cite=\"https://developer.mozilla.org/en-US/docs/Web/API/Web_Storage_API/Using_the_Web_Storage_API#Browser_compatibility\"><strong>subject to occasional clean up</strong>, ' +\r\n        'at the behest of the OS, typically if space is short.</q></li>');\r\n    }\r\n  });\r\n}());\r\n\r\n\r\n/////////////////////\r\n// Import & Export //\r\n/////////////////////\r\n\r\nfunction importDocument(obj) {\r\n  // duplicate data into the menu, then open it.\r\n  menu.duplicate(obj, {select: true, type: 'open'});\r\n}\r\n\r\n$(function () {\r\n  // Enable buttons now that handlers are ready\r\n  $('.tm-needsready').prop('disabled', false);\r\n\r\n  // Run import from URL query (if any)\r\n  var importArgs = {\r\n    dialogNode: getId('importDialog'),\r\n    importDocument: importDocument\r\n  };\r\n  require('./sharing/import').runImport(importArgs);\r\n  // Init import dialog\r\n  var $importPanel = $('#importPanel');\r\n  $importPanel.one('show.bs.modal', function () {\r\n    require('./sharing/import-panel').init({\r\n      $dialog: $importPanel,\r\n      gistIDForm: getId('gistIDForm'),\r\n      importArgs: importArgs\r\n    });\r\n  });\r\n  // Init export dialog\r\n  var exportPanel = getId('exportPanel');\r\n  require('./sharing/export-panel').init({\r\n    $dialog: $(exportPanel),\r\n    getCurrentDocument: function () {\r\n      controller.save(); // IMPORTANT: save changes, otherwise data model is out of date\r\n      return menu.currentDocument;\r\n    },\r\n    getIsSynced: controller.getIsSynced.bind(controller),\r\n    gistContainer: getId('shareGistContainer'),\r\n    downloadContainer: getId('exportDownloadContainer'),\r\n    copyContentsButton: getId('copyContentsButton'),\r\n    textarea: exportPanel.querySelector('textarea')\r\n  });\r\n});\r\n\r\n\r\n///////////////////\r\n// Document List //\r\n///////////////////\r\n\r\nvar menu = (function () {\r\n  var select = document.getElementById('tm-doc-menu');\r\n  // Group: Documents\r\n  var docGroup = document.createElement('optgroup');\r\n  docGroup.label = 'Documents';\r\n  select.appendChild(docGroup);\r\n  // Group: Examples\r\n  var exampleGroup = document.createElement('optgroup');\r\n  exampleGroup.label = 'Examples';\r\n  exampleGroup.appendChild(toDocFragment(examples.list.map(\r\n    DocumentMenu.prototype.optionFromDocument)));\r\n  select.appendChild(exampleGroup);\r\n\r\n  return new DocumentMenu({\r\n    menu: select,\r\n    group: docGroup,\r\n    storagePrefix: 'tm.docs',\r\n    firsttimeDocID: examples.firsttimeDocID\r\n  });\r\n})();\r\n\r\n\r\n/////////////////\r\n// \"Edit\" Menu //\r\n/////////////////\r\n\r\n(function () {\r\n  menu.onChange = function (doc, opts) {\r\n    switch (opts && opts.type) {\r\n      case 'duplicate':\r\n        controller.setBackingDocument(doc);\r\n        break;\r\n      case 'delete':\r\n        controller.forceLoadDocument(doc);\r\n        break;\r\n      default:\r\n        controller.openDocument(doc);\r\n    }\r\n    refreshEditMenu();\r\n  };\r\n\r\n  // Refresh the \"Edit\" menu items depending on document vs. example.\r\n  var refreshEditMenu = (function () {\r\n    var renameLink = document.querySelector('[data-target=\"#renameDialog\"]');\r\n    var deleteLink = document.querySelector('[data-target=\"#deleteDialog\"]');\r\n    var wasExample;\r\n    function renameExample() {\r\n      // duplicate, then rename the duplicate.\r\n      // how it works: switch to duplicate document ->\r\n      //   refreshEditMenu() enables rename dialog -> event bubbles up -> dialog opens.\r\n      // this might be the simplest way; Event.stopPropagation leaves the dropdown hanging.\r\n      duplicateDocument();\r\n    }\r\n\r\n    return function () {\r\n      var isExample = menu.currentDocument.isExample;\r\n      if (wasExample !== isExample) {\r\n        if (!isExample) {\r\n          renameLink.textContent = 'Rename…';\r\n          renameLink.removeEventListener('click', renameExample);\r\n          renameLink.setAttribute('data-toggle', 'modal');\r\n          deleteLink.textContent = 'Delete…';\r\n          deleteLink.setAttribute('data-target', '#deleteDialog');\r\n        } else {\r\n          renameLink.textContent = 'Rename a copy…';\r\n          renameLink.addEventListener('click', renameExample);\r\n          renameLink.removeAttribute('data-toggle');\r\n          deleteLink.textContent = 'Reset this example…';\r\n          deleteLink.setAttribute('data-target', '#resetExampleDialog');\r\n        }\r\n        wasExample = isExample;\r\n      }\r\n    };\r\n  }());\r\n  refreshEditMenu();\r\n\r\n  // only swap out the storage backing; don't affect views or undo history\r\n  function duplicateDocument() {\r\n    controller.save();\r\n    menu.duplicate(menu.currentDocument, {select: true});\r\n  }\r\n\r\n  function newBlankDocument() {\r\n    menu.newDocument({select: true});\r\n    // load up starter template\r\n    if (controller.editor.insertSnippet) { // async loaded\r\n      controller.editor.insertSnippet(examples.blankTemplate);\r\n      controller.loadEditorSource();\r\n    }\r\n  }\r\n\r\n  var $renameDialog = $(getId('renameDialog'));\r\n  [{id: 'tm-doc-action-duplicate', callback: duplicateDocument},\r\n  {id: 'tm-doc-action-newblank', callback: newBlankDocument}\r\n  ].forEach(function (item) {\r\n    document.getElementById(item.id).addEventListener('click', function (e) {\r\n      e.preventDefault();\r\n      item.callback(e);\r\n\r\n      $renameDialog.modal({keyboard: false})\r\n        .one('hidden.bs.modal', function () {\r\n          controller.editor.focus();\r\n        });\r\n    });\r\n  });\r\n}());\r\n\r\n\r\n/////////////\r\n// Dialogs //\r\n/////////////\r\n\r\n(function () {\r\n  // Rename\r\n  var $renameDialog = $(getId('renameDialog'));\r\n  var renameBox = getId('renameDialogInput');\r\n  $renameDialog\r\n    .on('show.bs.modal', function () {\r\n      renameBox.value = menu.currentOption.text;\r\n    })\r\n    .on('shown.bs.modal', function () {\r\n      renameBox.select();\r\n    })\r\n    // NB. remember data-keyboard=\"false\" on the triggering element,\r\n    // to prevent closing with Esc and causing a save.\r\n    // remark: an exception thrown on 'hide' prevents the dialog from closing,\r\n    // so save during 'hidden' instead.\r\n    .on('hidden.bs.modal', function () {\r\n      var newName = renameBox.value;\r\n      if (menu.currentOption.text !== newName) {\r\n        menu.rename(newName);\r\n      }\r\n      renameBox.value = '';\r\n    });\r\n  document.getElementById('renameDialogForm').addEventListener('submit', function (e) {\r\n    e.preventDefault();\r\n    $renameDialog.modal('hide');\r\n  });\r\n\r\n  // Delete\r\n  function deleteDocument() {\r\n    menu.delete();\r\n  }\r\n  document.getElementById('tm-doc-action-delete').addEventListener('click', deleteDocument);\r\n\r\n  // Reset Example\r\n  function discardReset() {\r\n    menu.delete();\r\n    // load manually since example stays and selection doesn't change\r\n    controller.forceLoadDocument(menu.currentDocument);\r\n  }\r\n  function saveReset() {\r\n    menu.duplicate(menu.currentDocument, {select: false});\r\n    discardReset();\r\n  }\r\n  document.getElementById('tm-doc-action-resetdiscard').addEventListener('click', discardReset);\r\n  document.getElementById('tm-doc-action-resetsave').addEventListener('click', saveReset);\r\n}());\r\n\r\n////////////////\r\n// Controller //\r\n////////////////\r\n\r\nvar controller = (function () {\r\n  function getButton(container, type) {\r\n    return container.querySelector('button.tm-' + type);\r\n  }\r\n  var editor = document.getElementById('editor-container');\r\n  // button containers\r\n  var sim = document.getElementById('controls-container');\r\n  var ed = editor.parentNode;\r\n\r\n  return new TMDocumentController({\r\n    simulator: document.getElementById('machine-container'),\r\n    editorAlerts: document.getElementById('editor-alerts-container'),\r\n    editor: editor\r\n  }, {\r\n    simulator: {\r\n      run: getButton(sim, 'run'),\r\n      step: getButton(sim, 'step'),\r\n      reset: getButton(sim, 'reset')\r\n    },\r\n    editor: {\r\n      runlog: getButton(ed, 'editor-runlog'),\r\n      load: getButton(ed, 'editor-load'),\r\n      revert: getButton(ed, 'editor-revert')\r\n    }\r\n  }, menu.currentDocument);\r\n}());\r\n\r\ncontroller.editor.setTheme('ace/theme/chrome');\r\ncontroller.editor.commands.addCommand({\r\n  name: 'save',\r\n  bindKey: { mac: 'Cmd-S', win: 'Ctrl-S' },\r\n  exec: function () {\r\n    controller.loadEditorSource();\r\n  }\r\n});\r\ncontroller.editor.session.setUseWrapMode(true);\r\n$(function () {\r\n  try {\r\n    require('./kbdshortcuts').main(controller.editor.commands,\r\n      getId('kbdShortcutTable')\r\n    );\r\n  } catch (e) {\r\n    /* */\r\n  }\r\n});\r\n\r\nwindow.addEventListener('beforeunload', function (ev) {\r\n  try {\r\n    controller.save();\r\n    menu.saveCurrentDocID();\r\n  } catch (error) {\r\n    addAlertPane('warning',\r\n      '<h4>The current document could not be saved.</h4>'+\r\n      '<p>It’s likely that the <a href=\"https://en.wikipedia.org/wiki/Web_storage#Storage_size\" target=\"_blank\">local storage quota</a> was exceeded. ' +\r\n      'Try downloading a copy of this document, then deleting other documents to make space.</p>');\r\n    return (ev || window.event).returnValue =\r\n      'There is not enough space left to save the current document.';\r\n  }\r\n});\r\n\r\n// Keep the current document in sync across tabs/windows\r\nwindow.addEventListener('blur', function () {\r\n  // One tab saves the data...\r\n  controller.save();\r\n});\r\n(function () {\r\n  // ...and the other tab loads it.\r\n  var isReloading = false;\r\n  require('./TMDocument').addOutsideChangeListener(function (docID, prop) {\r\n    if (docID === controller.getDocument().id && prop !== 'name' && !isReloading) {\r\n      // Batch together property changes into one reload\r\n      isReloading = true;\r\n      setTimeout(function () {\r\n        isReloading = false;\r\n        // Preserve undo history\r\n        controller.forceLoadDocument(controller.getDocument(), true);\r\n\r\n      }, 100);\r\n    }\r\n  });\r\n}());\r\n\r\n// For interaction/debugging\r\nexports.controller = controller;\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/main.js\n// module id = 18\n// module chunks = 1","'use strict';\r\nvar TMSimulator = require('./TMSimulator'),\r\n    parser = require('./parser'),\r\n    util = require('./util'),\r\n    ace = require('ace-builds/src-min-noconflict'),\r\n    d3 = require('d3'),\r\n    KeyValueStorage = require('./storage').KeyValueStorage;\r\nvar TMSpecError = parser.TMSpecError;\r\nvar YAMLException = parser.YAMLException;\r\nvar UndoManager = ace.require('ace/undomanager').UndoManager;\r\n\r\n/**\r\n * For editing and displaying a TMDocument.\r\n * The controller coordinates the interactions between\r\n *   1. simulator\r\n *   2. code editor\r\n *   3. storage\r\n *\r\n * All container and button params are required.\r\n * @param {Object} containers\r\n *   Empty containers to use (contents will likely be replaced).\r\n * @param {HTMLDivElement} containers.simulator\r\n * @param {HTMLDivElement} containers.editorAlerts\r\n * @param {HTMLDivElement} containers.editor\r\n * @param {Object} buttons Buttons to use.\r\n * @param {HTMLButtonElement} buttons.simulator.run\r\n * @param {HTMLButtonElement} buttons.simulator.step\r\n * @param {HTMLButtonElement} buttons.simulator.reset\r\n * @param {HTMLButtonElement} buttons.editor.runlog For switching between editor and log\r\n * @param {HTMLButtonElement} buttons.editor.load For loading the editor source\r\n * @param {HTMLButtonElement} buttons.editor.revert For reverting the editor source\r\n * @param {TMDocument} document The document to load from and save to.\r\n */\r\nfunction TMDocumentController(containers, buttons, document) {\r\n  this.simulator = new TMSimulator(containers.simulator, buttons.simulator);\r\n\r\n  // Set up ace editor //\r\n  var editor = ace.edit(containers.editor);\r\n  editor.session.setOptions({\r\n    mode: 'ace/mode/yaml',\r\n    tabSize: 2,\r\n    useSoftTabs: true\r\n  });\r\n  editor.setOptions({\r\n    minLines: 15,\r\n    maxLines: 50\r\n  });\r\n  // suppress warning about\r\n  // \"Automatically scrolling cursor into view after selection change\"\r\n  editor.$blockScrolling = Infinity;\r\n\r\n  var editorButtons = buttons.editor;\r\n  var self = this;\r\n\r\n  KeyValueStorage.write('TMReload', '');\r\n\r\n  window.setInterval(function () {\r\n    if (KeyValueStorage.read('TMReload')){\r\n      self.loadEditorSource();\r\n      // save whenever \"Load\" is pressed\r\n      self.save();\r\n      //self.reset();\r\n      //self.editor.focus();\r\n      KeyValueStorage.write('TMReload', '');\r\n    }\r\n  }, 50);\r\n\r\n  editorButtons.runlog\r\n      .addEventListener('click', function () {\r\n        var divLog = window.document.getElementById('run-log');\r\n        var divEditor = window.document.getElementById('editor-container');\r\n\r\n        if (divLog.getAttribute(\"hidden\") === \"hidden\") {\r\n          divLog.removeAttribute(\"hidden\");\r\n          divEditor.setAttribute(\"hidden\", \"hidden\");\r\n          editorButtons.load.disabled = true;\r\n          editorButtons.revert.disabled = true;\r\n          editorButtons.runlog.innerHTML=\"Editor\";\r\n        } else {\r\n          divEditor.removeAttribute(\"hidden\");\r\n          divLog.setAttribute(\"hidden\", \"hidden\");\r\n          editorButtons.load.disabled = false;\r\n          editorButtons.revert.disabled = false;\r\n          editorButtons.runlog.innerHTML=\"Run Log\";\r\n        }\r\n      });\r\n  editorButtons.load\r\n      .addEventListener('click', function () {\r\n        self.loadEditorSource();\r\n        // save whenever \"Load\" is pressed\r\n        self.save();\r\n        self.editor.focus();\r\n      });\r\n  editorButtons.revert\r\n      .addEventListener('click', function () {\r\n        self.revertEditorSource();\r\n        self.editor.focus();\r\n      });\r\n\r\n  Object.defineProperties(this, {\r\n    __document: {\r\n      value: {editor: {}}, // dummy document that gets replaced\r\n      writable: true\r\n    },\r\n    buttons   : { value: buttons },\r\n    containers: { value: containers },\r\n    editor    : { value: editor, enumerable: true }\r\n  });\r\n  this.openDocument(document);\r\n}\r\n\r\nTMDocumentController.prototype.getDocument = function () {\r\n  return this.__document;\r\n};\r\n\r\n// set the backing document, without saving/loading or affecting the views.\r\nTMDocumentController.prototype.setBackingDocument = function (doc) {\r\n  this.__document = doc;\r\n};\r\n\r\n// save the current document, then open another one.\r\n// does nothing if the document ID is the same.\r\nTMDocumentController.prototype.openDocument = function (doc) {\r\n  if (this.getDocument().id === doc.id) { return; } // same document\r\n  this.save();\r\n  return this.forceLoadDocument(doc);\r\n};\r\n\r\n// (low-level) load the document. current data is discarded without saving.\r\n// this can be used to switch from a deleted document or reload a document.\r\nTMDocumentController.prototype.forceLoadDocument = function (doc, keepUndoHistory) {\r\n  this.setBackingDocument(doc);\r\n  var diagramSource = doc.sourceCode;\r\n  var editorSource = doc.editorSourceCode;\r\n  // init //\r\n  this.simulator.clear();\r\n  this.setEditorValue(editorSource == null ? diagramSource : editorSource);\r\n  // prevent undo-ing to the previous document. note: .reset() doesn't work\r\n  if (!keepUndoHistory) {\r\n    this.editor.session.setUndoManager(new UndoManager());\r\n  }\r\n\r\n  if (editorSource == null) {\r\n    // case: synced: load straight from editor.\r\n    this.loadEditorSource();\r\n  } else {\r\n    // case: not synced: editor has separate contents.\r\n    this.isSynced = false;\r\n    try {\r\n      this.simulator.sourceCode = diagramSource;\r\n      this.simulator.positionTable = doc.positionTable;\r\n    } catch (e) {\r\n      this.showCorruptDiagramAlert(true);\r\n    }\r\n  }\r\n};\r\n\r\nTMDocumentController.prototype.save = function () {\r\n  var doc = this.getDocument();\r\n  if (this.hasValidDiagram) {\r\n    // sidenote: deleting first can allow saving when space would otherwise be full\r\n    doc.editorSourceCode = this.isSynced ? undefined : this.editor.getValue();\r\n    doc.sourceCode = this.simulator.sourceCode;\r\n    doc.positionTable = this.simulator.positionTable;\r\n  } else {\r\n    if (doc.editorSourceCode == null) {\r\n      // case 1: editor was synced with the diagram.\r\n      //  only edit doc.sourceCode until it's fixed;\r\n      //  don't worsen the problem to case 2.\r\n      doc.sourceCode = this.editor.getValue();\r\n    } else {\r\n      // case 2: editor has separate contents.\r\n      //  this is more confusing, as there are two \"source code\" values to contend with.\r\n      doc.editorSourceCode = this.editor.getValue();\r\n    }\r\n  }\r\n};\r\n\r\n/**\r\n * Set the editor contents.\r\n * • Converts null to '', since editor.setValue(null) crashes.\r\n * • Clears the editor alerts.\r\n * @param {?string} str\r\n */\r\nTMDocumentController.prototype.setEditorValue = function (str) {\r\n  this.editor.setValue(util.coalesce(str, ''), -1 /* put cursor at start */);\r\n  this.setAlertErrors([]);\r\n};\r\n\r\n/////////////////////////\r\n// Error/Alert Display //\r\n/////////////////////////\r\n\r\nfunction aceAnnotationFromYAMLException(e) {\r\n  return {\r\n    row: e.mark.line,\r\n    column: e.mark.column,\r\n    text: 'Not valid YAML (possibly caused by a typo):\\n' + e.message,\r\n    type: 'error'\r\n  };\r\n}\r\n\r\nTMDocumentController.prototype.setAlertErrors = function (errors) {\r\n  var self = this;\r\n  var alerts = d3.select(self.containers.editorAlerts).selectAll('.alert')\r\n    .data(errors, function (e) { return String(e); }); // key by error description\r\n\r\n  alerts.exit().remove();\r\n\r\n  alerts.enter()\r\n    .append('div')\r\n      .attr('class', 'alert alert-danger')\r\n      .attr('role', 'alert')\r\n      .each(/** @this div */ function (e) {\r\n        var div = d3.select(this);\r\n        if (e instanceof YAMLException) {\r\n          var annot = aceAnnotationFromYAMLException(e);\r\n          var lineNum = annot.row + 1; // annotation lines start at 0; editor starts at 1\r\n          var column = annot.column;\r\n          div.append('strong')\r\n              .text('Syntax error on ')\r\n             .append('a')\r\n              .text('line ' + lineNum)\r\n              .on('click', function () {\r\n                self.editor.gotoLine(lineNum, column, true);\r\n                self.editor.focus();\r\n                // prevent scrolling, especially href=\"#\" scrolling to the top\r\n                d3.event.preventDefault();\r\n              })\r\n              .attr('href', '#' + self.containers.editor.id);\r\n          div.append('br');\r\n          // aside: text nodes aren't elements so they need to be wrapped (e.g. in span)\r\n          // https://github.com/mbostock/d3/issues/94\r\n          div.append('span').text('Possible reason: ' + e.reason);\r\n        } else if (e instanceof TMSpecError) {\r\n          div.html(e.message);\r\n        } else {\r\n          div.html('<strong>Unexpected error</strong>: ' + e);\r\n        }\r\n      });\r\n  self.editor.session.setAnnotations(\r\n    errors\r\n    .map(function (e) {\r\n      return (e instanceof YAMLException) ? aceAnnotationFromYAMLException(e) : null;\r\n    })\r\n    .filter(function (x) { return x; })\r\n  );\r\n};\r\n\r\n\r\n//////////////////////////////\r\n// Syncing diagram & editor //\r\n//////////////////////////////\r\n\r\n// Sync Status\r\n\r\n// This method can be overridden as necessary.\r\n// The default implementation toggles Bootstrap 3 classes.\r\nTMDocumentController.prototype.setLoadButtonSuccess = function (didSucceed) {\r\n  d3.select(this.buttons.editor.load)\r\n      .classed({\r\n        'btn-success': didSucceed,\r\n        'btn-primary': !didSucceed\r\n      });\r\n};\r\n\r\n// internal. whether the editor and diagram source code are in sync, and the diagram is valid.\r\n// Updates \"Load machine\" button display.\r\n// for future reference: .isSynced cannot be moved to TMDocument because it requires knowledge from the simulator.\r\nObject.defineProperty(TMDocumentController.prototype, 'isSynced', {\r\n  set: function (isSynced) {\r\n    isSynced = Boolean(isSynced);\r\n    if (this.__isSynced !== isSynced) {\r\n      this.__isSynced = isSynced;\r\n      this.setLoadButtonSuccess(isSynced);\r\n      if (isSynced) {\r\n        // changes cause desync\r\n        var onChange = function () {\r\n          this.isSynced = false;\r\n          this.editor.removeListener('change', onChange);\r\n        }.bind(this);\r\n        this.editor.on('change', onChange);\r\n      }\r\n    }\r\n  },\r\n  get: function () { return this.__isSynced; }\r\n});\r\n\r\n// public API for isSynced\r\nTMDocumentController.prototype.getIsSynced = function () {\r\n  return Boolean(this.isSynced);\r\n};\r\n\r\n// Load & Revert\r\n\r\n// internal. used to detect when an imported document is corrupted.\r\nObject.defineProperty(TMDocumentController.prototype, 'hasValidDiagram', {\r\n  get: function () {\r\n    return Boolean(this.simulator.sourceCode);\r\n  }\r\n});\r\n\r\n/**\r\n * Show/hide the notice that the diagram's source code is invalid;\r\n * use this when the editor has contents of its own (so it can't display the diagram's source).\r\n *\r\n * This happens for imported documents that were corrupted.\r\n * It can also happen if the value in storage is tampered with.\r\n * @param  {boolean} show true to display immediately, false to hide.\r\n */\r\nTMDocumentController.prototype.showCorruptDiagramAlert = function (show) {\r\n  function enquote(s) { return '<q>' + s + '</q>'; }\r\n  var div = d3.select(this.simulator.container);\r\n  if (show) {\r\n    var revertName = this.buttons.editor.revert.textContent.trim();\r\n    div.html('')\r\n      .append('div')\r\n        .attr('class', 'alert alert-danger')\r\n        .html('<h4>This imported document has an error</h4>' +\r\n          [ 'The diagram was not valid and could not be displayed.'\r\n          , 'You can either load a new diagram from the editor, or attempt to recover this one'\r\n          , 'using ' + enquote(revertName) + ' (which will replace the current editor contents).'\r\n          ].join('<br>')\r\n        );\r\n  } else {\r\n    div.selectAll('.alert').remove();\r\n  }\r\n};\r\n\r\n// Sync from editor to diagram\r\nTMDocumentController.prototype.loadEditorSource = function () {\r\n  // load to diagram, and report any errors\r\n  var errors = (function () {\r\n    try {\r\n      var isNewDiagram = !this.hasValidDiagram;\r\n      this.simulator.sourceCode = this.editor.getValue();\r\n      if (isNewDiagram) {\r\n        // loaded new, or recovery succeeded => close error notice, restore positions\r\n        this.showCorruptDiagramAlert(false);\r\n        this.simulator.positionTable = this.getDocument().positionTable;\r\n      }\r\n      // .toJSON() is the only known way to preserve the cursor/selection(s)\r\n      // this.__loadedEditorSelection = this.editor.session.selection.toJSON();\r\n      return [];\r\n    } catch (e) {\r\n      return [e];\r\n    }\r\n  }.call(this));\r\n  this.isSynced = (errors.length === 0);\r\n  this.setAlertErrors(errors);\r\n};\r\n\r\n// Sync from diagram to editor\r\nTMDocumentController.prototype.revertEditorSource = function () {\r\n  this.setEditorValue(this.hasValidDiagram\r\n    ? this.simulator.sourceCode\r\n    : this.getDocument().sourceCode);\r\n\r\n  if (this.hasValidDiagram) {\r\n    this.isSynced = true;\r\n  } else {\r\n    // show errors when reverting to a corrupted diagram\r\n    this.loadEditorSource();\r\n  }\r\n  // if (this.__loadedEditorSelection) {\r\n  //   this.editor.session.selection.fromJSON(this.__loadedEditorSelection);\r\n  // }\r\n};\r\n\r\nmodule.exports = TMDocumentController;\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/TMDocumentController.js\n// module id = 19\n// module chunks = 1","'use strict';\n\nvar parseSpec = require('./parser').parseSpec,\n    TMViz = require('./TMViz'),\n    watchInit = require('./watch').watchInit,\n    values = require('lodash').values;\n\n/**\n * Turing machine simulator component.\n *\n * Contains a state diagram, tape diagram, and button controls.\n * @param {[type]} container [description]\n * @param {[type]} buttons   [description]\n */\nfunction TMSimulator(container, buttons) {\n  this.container = container;\n  this.buttons = buttons;\n\n  var self = this;\n  buttons.step\n      .addEventListener('click', function () {\n        self.machine.isRunning = false;\n        self.machine.step(); // each step click corresponds to 1 machine step\n      });\n  buttons.run\n      .addEventListener('click', function () {\n        self.machine.isRunning = !self.machine.isRunning;\n      });\n  buttons.reset\n      .addEventListener('click', function () {\n        self.machine.reset();\n      });\n  buttons.all = values(buttons);\n\n  this.clear();\n}\n\nTMSimulator.prototype.clear = function () {\n  this.sourceCode = null;\n};\n\nObject.defineProperties(TMSimulator.prototype, {\n  /**\n   * The machine's source code.\n   * • Setting a new source code will attempt to persist the state node positions.\n   * • To set a new machine, first call .clear(), then set the source code.\n   */\n  sourceCode: { // this is the getter and setter for the yaml code inside the ace editor\n    get: function () {\n      return this.__sourceCode;\n    },\n    // throws if sourceCode has errors\n    set: function (sourceCode) {\n      if (this.machine) {\n        this.machine.isRunning = false; // important\n        this.machine.stateviz.force.stop();\n      }\n      if (sourceCode == null) {\n        // clear display\n        this.machine = null;\n        this.container.innerHTML = '';\n      } else {\n        // parse & check, then set\n        var spec = parseSpec(sourceCode);\n        if (this.machine) {\n          // case: update\n          // copy & restore positions, clear & load contents\n          var posTable = this.machine.positionTable;\n          this.clear();\n          this.machine = new TMViz(this.container, spec, posTable);\n        } else {\n          // case: load new\n          this.machine = new TMViz(this.container, spec);\n        }\n      }\n      this.__sourceCode = sourceCode;\n    },\n    enumerable: true\n  },\n  positionTable: {\n    get: function () {\n      return this.machine && this.machine.positionTable;\n    },\n    set: function (posTable) {\n      if (this.machine && posTable) {\n        this.machine.positionTable = posTable;\n      }\n    },\n    enumerable: true\n  },\n  machine: {\n    get: function () {\n      return this.__machine;\n    },\n    set: function (machine) {\n      this.__machine = machine;\n      this.rebindButtons();\n    }\n  }\n});\n\n/////////////\n// Buttons //\n/////////////\n\n/**\n * The innerHTML for the \"Run\" button.\n * The default value can be overridden.\n * @type {string}\n */\nTMSimulator.prototype.htmlForRunButton =\n  '<span class=\"glyphicon glyphicon-play\" aria-hidden=\"true\"></span><br>Run';\nTMSimulator.prototype.htmlForPauseButton =\n  '<span class=\"glyphicon glyphicon-pause\" aria-hidden=\"true\"></span><br>Pause';\n\n// bind: .disabled for Step and Run, and .innerHTML (Run/Pause) for Run\nfunction rebindStepRun(stepButton, runButton, runHTML, pauseHTML, machine) {\n  function onHaltedChange(isHalted) {\n    stepButton.disabled = isHalted;\n    runButton.disabled = isHalted;\n  }\n  function onRunningChange(isRunning) {\n    runButton.innerHTML = isRunning ? pauseHTML : runHTML;\n  }\n  watchInit(machine, 'isHalted', function (prop, oldval, isHalted) {\n    onHaltedChange(isHalted);\n    return isHalted;\n  });\n  watchInit(machine, 'isRunning', function (prop, oldval, isRunning) {\n    onRunningChange(isRunning);\n    return isRunning;\n  });\n}\n\n// internal method.\nTMSimulator.prototype.rebindButtons = function () {\n  var buttons = this.buttons;\n  var enable = (this.machine != null);\n  if (enable) {\n    rebindStepRun(buttons.step, buttons.run,\n      this.htmlForRunButton, this.htmlForPauseButton, this.machine);\n  }\n  buttons.all.forEach(function (b) { b.disabled = !enable; });\n};\n\nmodule.exports = TMSimulator;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/TMSimulator.js\n// module id = 20\n// module chunks = 1","'use strict';\n\n/* global document */\nvar KeyValueStorage = require('./storage').KeyValueStorage;\nvar TMDocument = require('./TMDocument');\nvar d3 = require('d3');\nvar defaults = require('lodash/fp').defaults; // NB. 2nd arg takes precedence\n\n/**\n * Document menu controller.\n *\n * The view is fully determined by a 3-tuple: ([ID], ID -> Name, currentID).\n * @constructor\n * @param {Object}  args                  argument object\n * @param {HTMLSelectElement}\n *                  args.menu\n * @param {?Node}  [args.group=args.menu] Node to add documents to.\n * @param {string}  args.storagePrefix\n * @param {?(TMDocument -> HTMLOptionElement)}\n *                  args.makeOption       Customize rendering for each document entry.\n * @param {?string} args.firsttimeDocID   Document to open on the first visit.\n */\nfunction DocumentMenu(args) {\n  var menu = args.menu,\n      group = args.group || menu,\n      storagePrefix = args.storagePrefix,\n      firsttimeDocID = args.firsttimeDocID;\n\n  if (!menu) {\n    throw new TypeError('DocumentMenu: missing parameter: menu element');\n  } else if (!storagePrefix) {\n    throw new TypeError('DocumentMenu: missing parameter: storage prefix');\n  }\n  if (args.makeOption) {\n    this.optionFromDocument = args.makeOption;\n  }\n  this.menu = menu;\n  this.group = group;\n  this.group.innerHTML = '';\n  this.__storagePrefix = storagePrefix;\n\n  // Load document entries (non-examples)\n  this.doclist = new DocumentList(storagePrefix + '.list');\n  this.render();\n  // Re-open last-opened document\n  this.selectDocID(this.getSavedCurrentDocID() || firsttimeDocID);\n\n  // Listen for selection changes\n  var self = this;\n  this.menu.addEventListener('change', function () {\n    //if the editor isnt visible, hide the runlog, open the editor\n    var divLog = window.document.getElementById('run-log');\n    var divEditor = window.document.getElementById('editor-container');\n    var editorLoad = window.document.getElementById('editor-load');\n    var editorRevert = window.document.getElementById('editor-revert');\n    var editorRunlog = window.document.getElementById('editor-runlog');\n\n    if (!(divLog.getAttribute(\"hidden\") === \"hidden\")) {\n      divEditor.removeAttribute(\"hidden\");\n      divLog.setAttribute(\"hidden\", \"hidden\");\n      editorLoad.disabled = false;\n      editorRevert.disabled = false;\n      editorRunlog.innerHTML=\"Run Log\";\n    }\n\n    //make sure to also reset the label boxes so we don't keep a selection accidentally\n    var nodeLabel = window.document.getElementById('nodeLabel');\n    var read = window.document.getElementById('read');\n    var write = window.document.getElementById('write');\n    nodeLabel.value = \"\";\n    read.value = \"\";\n    write.value = \"\";\n\n    //now make it look normal\n    nodeLabel.disabled = true;\n    window.document.getElementById('node-edit-controls').setAttribute(\"style\", \"display: flex\");\n    window.document.getElementById('transition-edit-controls').setAttribute(\"style\", \"display: none\");\n    window.document.getElementById('startState').disabled = true;\n    window.document.getElementById('deleteNode').disabled = true;\n    self.onChange(self.currentDocument, {type: 'open'});\n  });\n\n  // Listen for storage changes in other tabs/windows\n  KeyValueStorage.addStorageListener(function (e) {\n    var docID;\n    var option, newOption;\n\n    if (e.key === self.doclist.storageKey) {\n      // case: [ID] list changed\n      self.doclist.readList();\n      self.render();\n    } else if ( (docID = TMDocument.IDFromNameStorageKey(e.key)) ) {\n      // case: single document renamed: (ID -> Name) changed\n      option = self.findOptionByDocID(docID);\n      if (option) {\n        // replace the whole <option>, to be consistent with .optionFromDocument\n        option.parentNode.replaceChild(\n          newOption = self.optionFromDocument(new TMDocument(docID)),\n          option\n        );\n        newOption.selected = option.selected;\n        d3.select(newOption).datum( d3.select(option).datum() );\n      }\n    }\n  });\n}\n\nObject.defineProperties(DocumentMenu.prototype, {\n  currentOption: {\n    get: function () {\n      return this.menu.options[this.menu.selectedIndex];\n    },\n    enumerable: true\n  },\n  currentDocument: {\n    get: function () {\n      var opt = this.currentOption;\n      return opt ? new TMDocument(opt.value) : null;\n    },\n    enumerable: true\n  }\n});\n\nDocumentMenu.prototype.render = function () {\n  var currentDocID = this.currentOption ? this.currentOption.value : null;\n\n  var option = d3.select(this.group).selectAll('option')\n    .data(this.doclist.list, function (entry) { return entry.id; });\n\n  option.exit().remove();\n\n  var self = this;\n  option.enter().insert(function (entry) {\n    return self.optionFromDocument(new TMDocument(entry.id));\n  });\n\n  // If current document was deleted, switch to another document\n  if (this.currentOption.value !== currentDocID) {\n    // fallback 1: saved current docID\n    if (!this.selectDocID(this.getSavedCurrentDocID(), {type: 'delete'})) {\n      // fallback 2: whatever is now selected\n      this.onChange(this.currentDocument, {type: 'delete'});\n    }\n  }\n};\n\n// Returns the <option> whose 'value' attribute is docID.\nDocumentMenu.prototype.findOptionByDocID = function (docID) {\n  return this.menu.querySelector('option[value=\"' + docID.replace(/\"/g, '\\\\\"') + '\"]');\n};\n\n// Selects (switches the active item to) the given docID. Returns true on success.\nDocumentMenu.prototype.selectDocID = function (docID, opts) {\n  try {\n    this.findOptionByDocID(docID).selected = true;\n  } catch (e) {\n    return false;\n  }\n  this.onChange(this.currentDocument, opts);\n  return true;\n};\n\n// Saves the current (selected) docID to storage.\nDocumentMenu.prototype.saveCurrentDocID = function () {\n  var docID = this.currentOption && this.currentOption.value;\n  if (docID) {\n    KeyValueStorage.write(this.__storagePrefix + '.currentDocID', docID);\n  }\n};\n\n// Returns the saved current docID, otherwise null.\nDocumentMenu.prototype.getSavedCurrentDocID = function () {\n  return KeyValueStorage.read(this.__storagePrefix + '.currentDocID');\n};\n\n// Configurable methods\n\nDocumentMenu.prototype.optionFromDocument = function (doc) {\n  var option = document.createElement('option');\n  option.value = doc.id;\n  option.text = doc.name || 'untitled';\n  return option;\n};\n\n// Called when the current document ID changes\n// through user action (<select>) or this class's API.\n// The callback receives the new value of .currentDocument,\n// along with the options object (whose .type\n// is 'duplicate', 'delete', or 'open').\nDocumentMenu.prototype.onChange = function () {\n};\n\n// Internal Helpers\n\n// prepend then select\nDocumentMenu.prototype.__prepend = function (doc, opts) {\n  var option = this.optionFromDocument(doc);\n  this.group.insertBefore(option, this.group.firstChild);\n  if (opts && opts.select) {\n    this.menu.selectedIndex = option.index;\n    this.onChange(doc, opts);\n  }\n  return doc;\n};\n\n// Methods not about Current Document\n\nDocumentMenu.prototype.newDocument = function (opts) {\n  return this.__prepend(this.doclist.newDocument(), defaults({type: 'open'}, opts));\n};\n\n// Methods about Current Document\n\nDocumentMenu.prototype.duplicate = function (doc, opts) {\n  return this.__prepend(this.doclist.duplicate(doc), defaults({type: 'duplicate'}, opts));\n};\n\nDocumentMenu.prototype.rename = function (name) {\n  this.currentDocument.name = name;\n  this.currentOption.text = name;\n};\n\n// required invariant: one option is always selected.\n// returns true if the current entry was removed from the list.\nDocumentMenu.prototype.delete = function (opts) {\n  this.currentDocument.delete();\n  var index = this.menu.selectedIndex;\n  var didDeleteEntry = this.doclist.deleteIndex(index);\n  if (didDeleteEntry) {\n    this.currentOption.remove();\n    this.menu.selectedIndex = index;\n    this.onChange(this.currentDocument, defaults({type: 'delete'}, opts));\n  }\n  return didDeleteEntry;\n};\n\n/////////////////////\n// Document List   //\n// (model/storage) //\n/////////////////////\n\n\n// for custom documents.\nfunction DocumentList(storageKey) {\n  this.storageKey = storageKey;\n  this.readList();\n}\n\n// () -> string\nDocumentList.newID = function () {\n  return String(Date.now());\n};\n\n// internal methods.\nDocumentList.prototype.add = function (docID) {\n  this.__list.unshift({id: docID});\n  this.writeList();\n};\nDocumentList.prototype.readList = function () {\n  this.__list = JSON.parse(KeyValueStorage.read(this.storageKey)) || [];\n};\nDocumentList.prototype.writeList = function () {\n  KeyValueStorage.write(this.storageKey, JSON.stringify(this.__list));\n};\n\nDocumentList.prototype.newDocument = function () {\n  var newID = DocumentList.newID();\n  this.add(newID);\n  return new TMDocument(newID);\n};\n\nDocumentList.prototype.duplicate = function (doc) {\n  return this.newDocument().copyFrom(doc);\n};\n\n/**\n * Behaves like list.splice(index, 1).\n * @param  {number} index index of the element to delete\n * @return {boolean} true if an element was removed, false otherwise (index out of bounds)\n */\nDocumentList.prototype.deleteIndex = function (index) {\n  var deleted = this.__list.splice(index, 1);\n  this.writeList();\n  return (deleted.length > 0);\n};\n\nObject.defineProperties(DocumentList.prototype, {\n  list: {\n    get: function () { return this.__list; },\n    enumerable: true\n  }\n});\n\nmodule.exports = DocumentMenu;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/DocumentMenu.js\n// module id = 21\n// module chunks = 1","'use strict';\n\nvar KeyValueStorage = require('./storage').KeyValueStorage,\n    examples = require('./examples'),\n    util = require('./util'),\n    _ = require('lodash/fp');\n\n/**\n * Document model (storage).\n * @param {string} docID Each document ID in a key-value store should be unique.\n *                       An ID is typically a timestamp. It should not contain '.'.\n */\nfunction TMDocument(docID) {\n  var preset = examples.get(docID);\n  Object.defineProperties(this, {\n    id:     { value: docID },\n    prefix: { value: 'doc.' + docID },\n    isExample: { value: preset ? true : false }\n  });\n  // fall back to reading presets for example documents\n  if (preset) {\n    Object.defineProperties(this, {\n      sourceCode: useFallbackGet(preset, this, 'sourceCode'),\n      // names are read-only\n      positionTable: useFallbackGet(preset, this, 'positionTable'),\n      name: {\n        get: function () { return preset.name; },\n        set: function () {}, // don't err when removing (set = null)\n        enumerable: true\n      }\n    });\n  }\n}\n\nfunction useFallbackGet(preset, obj, prop) {\n  var proto = Object.getPrototypeOf(obj);\n  var desc = Object.getOwnPropertyDescriptor(proto, prop);\n  var get = desc.get;\n  desc.get = function () {\n    return util.coalesce(get.call(obj), preset[prop]);\n  };\n  return desc;\n}\n\n// internal method.\nTMDocument.prototype.path = function (path) {\n  return [this.prefix, path].join('.');\n};\n\n(function () {\n  var store = KeyValueStorage;\n  var read = store.read.bind(store);\n  var write = function (key, val) {\n    if (val != null) {\n      store.write(key, val);\n    } else {\n      store.remove(key);\n    }\n  };\n  // var remove = store.remove.bind(store);\n  function stringProp(path) {\n    return {\n      get: function () { return read(this.path(path)); },\n      set: function (val) { write(this.path(path), val); },\n      enumerable: true\n    };\n  }\n\n  var propDescriptors = {\n    sourceCode: stringProp('diagram.sourceCode'),\n    positionTable: {\n      get: function () {\n        return util.applyMaybe(parsePositionTable,\n          read(this.path('diagram.positions')));\n      },\n      set: function (val) {\n        write(this.path('diagram.positions'),\n          util.applyMaybe(stringifyPositionTable, val));\n      },\n      enumerable: true\n    },\n    editorSourceCode: stringProp('editor.sourceCode'),\n    name: stringProp('name')\n  };\n  Object.defineProperties(TMDocument.prototype, propDescriptors);\n  TMDocument.prototype.dataKeys = Object.keys(propDescriptors);\n})();\n\n// IDEA: bypass extra parse & stringify cycle for positions\nTMDocument.prototype.copyFrom = function (other) {\n  this.dataKeys.forEach(function (key) {\n    this[key] = other[key];\n  }, this);\n  return this;\n};\n\nTMDocument.prototype.delete = function () {\n  this.copyFrom({});\n};\n\n// Cross-tab/window storage sync\n\n/**\n * Checks whether a storage key is for a document's name.\n * @return {?string} The document ID if true, otherwise null.\n */\nTMDocument.IDFromNameStorageKey = function (string) {\n  var result = /^doc\\.([^.]+)\\.name$/.exec(string);\n  return result && result[1];\n};\n\n/**\n * Registers a listener for document changes caused by other tabs/windows.\n * The listener receives the document ID and the property name that changed.\n * @param {Function} listener\n */\nTMDocument.addOutsideChangeListener = function (listener) {\n  var re = /^doc\\.([^.]+)\\.(.+)$/;\n\n  KeyValueStorage.addStorageListener(function (e) {\n    var matches = re.exec(e.key);\n    if (matches) {\n      listener(matches[1], matches[2]);\n    }\n  });\n};\n\n/////////////////////////\n// Position table JSON //\n/////////////////////////\n\n// JSON -> Object\nvar parsePositionTable = JSON.parse;\n\n// PositionTable -> JSON\nvar stringifyPositionTable = _.flow(\n  _.mapValues(truncateCoords(2)),\n  JSON.stringify\n);\n\n// Truncate .x .y .px .py to 2 decimal places, to save space.\nfunction truncateCoords(decimalPlaces) {\n  var multiplier = Math.pow(10, decimalPlaces);\n  function truncate(value) {\n    return Math.round(value * multiplier)/multiplier;\n  }\n\n  return function (val) {\n    var result =  _(val).pick(['x','y','px','py']).mapValues(truncate).value();\n    result.fixed = val.fixed;\n    return result;\n  };\n}\n\nmodule.exports = TMDocument;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/TMDocument.js\n// module id = 22\n// module chunks = 1","'use strict';\n\nvar parseDocument = require('./sharing/format').parseDocument;\nvar fromPairs = require('lodash/fp').fromPairs;\n\n\nfunction requireExample(name) {\n  return require('raw!./examples/' + name + '.yaml');\n}\n\nvar examplePairs = [\n  'repeat01',\n  'binaryIncrement',\n  'divisibleBy3',\n  'copy1s',\n  'divisibleBy3Base10',\n  'matchThreeLengths',\n  'matchBinaryStrings',\n  'palindrome',\n  'busyBeaver3',\n  'busyBeaver4',\n  'powersOfTwo',\n  'lengthMult',\n  'binaryAdd',\n  'unaryMult',\n  'binaryMult'\n].map(function (id) {\n  // parse each string into a document\n  var doc = parseDocument(requireExample(id));\n  doc.id = id;\n\n  return [id, doc];\n});\nvar examples = Object.freeze(fromPairs(examplePairs));\n\n\nfunction isExampleID(docID) {\n  return {}.hasOwnProperty.call(examples, docID);\n}\n\nfunction get(docID) {\n  return isExampleID(docID) ? examples[docID] : null;\n}\n\nvar list = examplePairs.map(function (pair) { return pair[1]; });\n\n\nexports.hasID = isExampleID;\nexports.get = get;\nexports.list = list;\nexports.firsttimeDocID = 'binaryIncrement';\nexports.blankTemplate = requireExample('_template');\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/examples.js\n// module id = 23\n// module chunks = 1","'use strict';\r\n\r\nvar jsyaml = require('js-yaml'),\r\n    _ = require('lodash/fp');\r\n\r\n// Document Serialization\r\n\r\nvar docToYaml = {\r\n  name: 'name',\r\n  sourceCode: 'source code',\r\n  positionTable: 'positions',\r\n  editorSourceCode: 'editor contents'\r\n};\r\nvar yamlToDoc = _.invert(docToYaml);\r\n\r\n// like _.mapKeys, but only using the keys specified in a mapping object.\r\n// {[key: string] -> string} -> ?Object -> Object\r\nfunction mapKeys(mapping) {\r\n  return function (input) {\r\n    var output = {};\r\n    if (input != null) {\r\n      Object.keys(mapping).forEach(function (fromKey) {\r\n        var toKey = mapping[fromKey];\r\n        output[toKey] = input[fromKey];\r\n      });\r\n    }\r\n    return output;\r\n  };\r\n}\r\n\r\n// we want parseDocument . stringifyDocument = identity, up to null == undefined.\r\n\r\n/**\r\n * Serialize a document.\r\n * For each state node position, only .x, .y, and .fixed are saved.\r\n * .fixed is omitted if true (its default value).\r\n * @param  {TMDocument} doc document to serialize\r\n * @return {string}\r\n */\r\nvar stringifyDocument = _.flow(\r\n  mapKeys(docToYaml),\r\n  _.omitBy(function (x) { return x == null; }),\r\n  _.update('positions', _.mapValues(function (pos) {\r\n    return pos.fixed\r\n      ? {x: pos.x, y: pos.y}\r\n      : {x: pos.x, y: pos.y, fixed: false};\r\n  })),\r\n  // NB. lodash/fp/partialRight takes an array of arguments.\r\n  _.partialRight(jsyaml.safeDump, [{\r\n    flowLevel: 2,       // positions: one state per line\r\n    lineWidth: -1,      // don't wrap lines\r\n    noRefs: true,       // no aliases/references are used\r\n    noCompatMode: true  // use y: instead of 'y':\r\n  }])\r\n);\r\n\r\n/**\r\n * Deserialize a document.\r\n * State positions' .px and .py are optional and default to .x and .y.\r\n * .fixed defaults to true.\r\n * @param  {string} str    serialized document\r\n * @return {Object}        data usable in TMDocument.copyFrom()\r\n * @throws {YAMLException} on YAML syntax error\r\n * @throws {TypeError}     when missing \"source code\" string property\r\n */\r\nvar parseDocument = _.flow(\r\n  jsyaml.safeLoad,\r\n  _.update('positions', _.mapValues(function (pos) {\r\n    // NB. lodash/fp/defaults is swapped: 2nd takes precedence\r\n    return _.defaults({px: pos.x, py: pos.y, fixed: true}, pos);\r\n  })),\r\n  mapKeys(yamlToDoc),\r\n  checkData\r\n);\r\n\r\n// throw if \"source code\" attribute is missing or not a string\r\nfunction checkData(obj) {\r\n  if (obj == null || obj.sourceCode == null) {\r\n    throw new InvalidDocumentError('The “source code:” value is missing');\r\n  } else if (!_.isString(obj.sourceCode)) {\r\n    throw new InvalidDocumentError('The “source code:” value needs to be of type string');\r\n  }\r\n  return obj;\r\n}\r\n\r\n// for valid YAML that is not valid as a document\r\nfunction InvalidDocumentError(message) {\r\n  this.name = 'InvalidDocumentError';\r\n  this.message = message || 'Invalid document';\r\n  this.stack = (new Error()).stack;\r\n}\r\nInvalidDocumentError.prototype = Object.create(Error.prototype);\r\nInvalidDocumentError.prototype.constructor = InvalidDocumentError;\r\n\r\nexports.stringifyDocument = stringifyDocument;\r\nexports.parseDocument = parseDocument;\r\nexports.InvalidDocumentError = InvalidDocumentError;\r\n\r\n// Re-exports\r\nexports.YAMLException = jsyaml.YAMLException;\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/sharing/format.js\n// module id = 24\n// module chunks = 1","var map = {\n\t\"./_template.yaml\": 26,\n\t\"./binaryAdd.yaml\": 27,\n\t\"./binaryIncrement.yaml\": 28,\n\t\"./binaryMult.yaml\": 29,\n\t\"./busyBeaver3.yaml\": 30,\n\t\"./busyBeaver4.yaml\": 31,\n\t\"./copy1s.yaml\": 32,\n\t\"./divisibleBy3.yaml\": 33,\n\t\"./divisibleBy3Base10.yaml\": 34,\n\t\"./lengthMult.yaml\": 35,\n\t\"./matchBinaryStrings.yaml\": 36,\n\t\"./matchThreeLengths.yaml\": 37,\n\t\"./palindrome.yaml\": 38,\n\t\"./powersOfTwo.yaml\": 39,\n\t\"./repeat01.yaml\": 40,\n\t\"./unaryMult.yaml\": 41\n};\nfunction webpackContext(req) {\n\treturn __webpack_require__(webpackContextResolve(req));\n};\nfunction webpackContextResolve(req) {\n\treturn map[req] || (function() { throw new Error(\"Cannot find module '\" + req + \"'.\") }());\n};\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 25;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/examples ./~/raw-loader!^\\.\\/.*\\.yaml$\n// module id = 25\n// module chunks = 1","module.exports = \"input: '${2}'\\r\\nblank: '${3:_}'\\r\\nstart state: ${4:start}\\r\\ntable:\\r\\n  ${4}: {}\\r\\n\"\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/raw-loader!./src/examples/_template.yaml\n// module id = 26\n// module chunks = 1","module.exports = \"name: binary addition\\r\\nsource code: |\\r\\n  input: 1011+11001\\r\\n  blank: _\\r\\n  start state: right\\r\\n  table:\\r\\n    right:\\r\\n      '0,1,+': R\\r\\n      _:\\r\\n        L: read\\r\\n    read:\\r\\n      '0':\\r\\n        write: c\\r\\n        L: have0\\r\\n      '1':\\r\\n        write: c\\r\\n        L: have1\\r\\n      +:\\r\\n        write: _\\r\\n        L: rewrite\\r\\n    have0:\\r\\n      '0,1': L\\r\\n      +:\\r\\n        L: add0\\r\\n    have1:\\r\\n      '0,1': L\\r\\n      +:\\r\\n        L: add1\\r\\n    add0:\\r\\n      '1':\\r\\n        write: I\\r\\n        R: back0\\r\\n      '0,_':\\r\\n        write: O\\r\\n        R: back0\\r\\n      'O,I': L\\r\\n    add1:\\r\\n      '1':\\r\\n        write: O\\r\\n        L: carry\\r\\n      '0,_':\\r\\n        write: I\\r\\n        R: back1\\r\\n      'O,I': L\\r\\n    carry:\\r\\n      '1':\\r\\n        write: 0\\r\\n        L: carry\\r\\n      '0,_':\\r\\n        write: 1\\r\\n        R: back1\\r\\n    back0:\\r\\n        '0,1,O,I,+': R\\r\\n        c:\\r\\n          write: 0\\r\\n          L: read\\r\\n    back1:\\r\\n        '0,1,O,I,+': R\\r\\n        c:\\r\\n          write: 1\\r\\n          L: read\\r\\n    rewrite:\\r\\n        O:\\r\\n          write: 0\\r\\n          L: rewrite\\r\\n        I:\\r\\n          write: 1\\r\\n          L: rewrite\\r\\n        '0,1': L\\r\\n        _:\\r\\n          R: done\\r\\n    done: {}\\r\\n\\r\\n  \\r\\n  # Adds two binary numbers together.\\r\\n\\r\\n  # Format: Given input a+b where a and b are binary numbers,\\r\\n  # leaves c b on the tape, where c = a+b.\\r\\n  # Example: '11+1' => '100 1'.\\r\\n  \\r\\n  # Steps:\\r\\n  # Start at the second number's rightmost digit.\\r\\n  # Add each digit from right to left:\\r\\n  # read the current digit of the second number,\\r\\n  # and add it to the next place of the first number,\\r\\n  # marking the place (using O or I) as already added.\\r\\n  # Then, restore the current digit, and repeat with the next digit.\\r\\n  # Finish: rewrite place markers back to 0s and 1s.\\r\\n\\r\\n  # Exercise:\\r\\n\\r\\n  # • Generate the Fibonacci sequence in binary, listed from right to left:\\r\\n  #   ...1101 1000 101 11 10 1 1 0\\r\\n  #   Hint: prefix the current number with a +, copy the previous number\\r\\n  #   and place it left of the +, run the adder, and repeat.\\r\\n  #   Example: '1 0' => '+1 0' => '0+1 0' => '1 1 0' => '+1 1 0' => ...\\r\\npositions:\\r\\n  right:   {x: 300, y: 130}\\r\\n  rewrite: {x: 500, y: 130}\\r\\n  done:    {x: 620, y: 130}\\r\\n\\r\\n  back0:  {x: 250, y: 250}\\r\\n  read:   {x: 400, y: 250}\\r\\n  back1:  {x: 550, y: 250}\\r\\n  carry:  {x: 650, y: 250}\\r\\n\\r\\n  add0:   {x: 150, y: 400}\\r\\n  have0:  {x: 300, y: 400}\\r\\n  have1:  {x: 500, y: 400}\\r\\n  add1:   {x: 650, y: 400}\\r\\n\"\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/raw-loader!./src/examples/binaryAdd.yaml\n// module id = 27\n// module chunks = 1","module.exports = \"name: binary increment\\r\\nsource code: |\\r\\n  input: '1011'\\r\\n  blank: _\\r\\n  start state: right\\r\\n  table:\\r\\n    right:\\r\\n      '1,0': R\\r\\n      _:\\r\\n        L: carry\\r\\n    carry:\\r\\n      '1':\\r\\n        write: 0\\r\\n        L: carry\\r\\n      '0,_':\\r\\n        write: 1\\r\\n        L: done\\r\\n    done: {}\\r\\n\\r\\n\\r\\n  # Adds 1 to a binary number.\\r\\n\\r\\n  # Steps:\\r\\n  # scan to the rightmost digit\\r\\n  # then carry the 1\\r\\n\\r\\n  # Exercises:\\r\\n\\r\\n  # • Modify the machine to always halt on the leftmost digit\\r\\n  #   (regardless of the number's length).\\r\\n  #   Hint: add a state between carry and done.\\r\\n\\r\\n  # • Make a machine that adds 2 instead of 1.\\r\\n  #   Hint: 2 is '10' in binary, so the last digit is unaffected.\\r\\n  #   Alternative hint: chain together two copies of the machine from\\r\\n  #   the first exercise (renaming the states of the second copy).\\r\\n\\r\\n  # • Make a machine to subtract 1.\\r\\n  #   To simplify things, assume the input is always greater than 0.\\r\\npositions:\\r\\n  right: {x: 230, y: 250}\\r\\n  carry: {x: 400, y: 250}\\r\\n  done: {x: 570, y: 250}\\r\\n\"\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/raw-loader!./src/examples/binaryIncrement.yaml\n// module id = 28\n// module chunks = 1","module.exports = \"name: binary multiplication\\r\\nsource code: |\\r\\n  input: 11*101\\r\\n  blank: _\\r\\n  start state: start\\r\\n  table:\\r\\n    start:\\r\\n      '0,1':\\r\\n        L: init\\r\\n    init:\\r\\n      _:\\r\\n        write: +\\r\\n        R: right\\r\\n    right:\\r\\n      '0,1,*': R\\r\\n      _:\\r\\n        L: readB\\r\\n    readB:\\r\\n      '0':\\r\\n        write: _\\r\\n        L: doubleL\\r\\n      '1':\\r\\n        write: _\\r\\n        L: addA\\r\\n    addA:\\r\\n      '0,1': L\\r\\n      '*':\\r\\n        L: read\\r\\n    doubleL:\\r\\n      '0,1': L\\r\\n      '*':\\r\\n        write: 0\\r\\n        R: shift\\r\\n    double:\\r\\n      '0,1,+': R\\r\\n      '*':\\r\\n        write: 0\\r\\n        R: shift\\r\\n    shift:\\r\\n      '0':\\r\\n        write: '*'\\r\\n        R: shift0\\r\\n      '1':\\r\\n        write: '*'\\r\\n        R: shift1\\r\\n      _:\\r\\n        L: tidy\\r\\n    shift0:\\r\\n      '0':\\r\\n        R: shift0\\r\\n      '1':\\r\\n        write: 0\\r\\n        R: shift1\\r\\n      _:\\r\\n        write: 0\\r\\n        R: right\\r\\n    shift1:\\r\\n      '0':\\r\\n        write: 1\\r\\n        R: shift0\\r\\n      '1':\\r\\n        R: shift1\\r\\n      _:\\r\\n        write: 1\\r\\n        R: right\\r\\n    tidy:\\r\\n      '0,1':\\r\\n        write: _\\r\\n        L: tidy\\r\\n      +:\\r\\n        write: _\\r\\n        L: done\\r\\n    done: {}\\r\\n    read:\\r\\n      '0':\\r\\n        write: c\\r\\n        L: have0\\r\\n      '1':\\r\\n        write: c\\r\\n        L: have1\\r\\n      +:\\r\\n        L: rewrite\\r\\n    have0:\\r\\n      '0,1': L\\r\\n      +:\\r\\n        L: add0\\r\\n    have1:\\r\\n      '0,1': L\\r\\n      +:\\r\\n        L: add1\\r\\n    add0:\\r\\n      '1':\\r\\n        write: I\\r\\n        R: back0\\r\\n      'O,I': L\\r\\n      '0,_':\\r\\n        write: O\\r\\n        R: back0\\r\\n    add1:\\r\\n      '1':\\r\\n        write: O\\r\\n        L: carry\\r\\n      'O,I': L\\r\\n      '0,_':\\r\\n        write: I\\r\\n        R: back1\\r\\n    carry:\\r\\n      '1':\\r\\n        write: 0\\r\\n        L: carry\\r\\n      '0,_':\\r\\n        write: 1\\r\\n        R: back1\\r\\n    back0:\\r\\n      '0,1,O,I,+': R\\r\\n      c:\\r\\n        write: 0\\r\\n        L: read\\r\\n    back1:\\r\\n      '0,1,O,I,+': R\\r\\n      c:\\r\\n        write: 1\\r\\n        L: read\\r\\n    rewrite:\\r\\n      O:\\r\\n        write: 0\\r\\n        L: rewrite\\r\\n      I:\\r\\n        write: 1\\r\\n        L: rewrite\\r\\n      '0,1': L\\r\\n      _:\\r\\n        R: double\\r\\n  \\r\\n  \\r\\n  # Multiplies two binary numbers together.\\r\\n\\r\\n  # Examples: '11*11' => '1001', '111*110' => '101010'.\\r\\n  \\r\\n  # Steps:\\r\\n  # Prefix the input with a '+', and go to the rightmost digit.\\r\\n  # Read and erase the last digit of the multiplier.\\r\\n  # If it's 1, add the current multiplicand.\\r\\n  # In any case, double the multiplicand afterwards.\\r\\n  # Make room by shifting the multiplier right 1 cell.\\r\\n  \\r\\n  # This uses the 'binary addition' machine almost verbatim.\\r\\n  # It's adjusted to keep the '+'\\r\\n  # and to lead to another state instead of halting.\\r\\n\\r\\n  # Remark:\\r\\n  # We can view the machine as expressing a recursive function:\\r\\n\\r\\n  #   multiply(a, b) = mult(0, a, b)\\r\\n\\r\\n  #   mult(acc, a, 0     ) = acc\\r\\n  #   mult(acc, a, 2k + 0) = mult(acc    , 2a, k)   where k ≠ 0\\r\\n  #   mult(acc, a, 2k + 1) = mult(acc + a, 2a, k)\\r\\n\\r\\n  # where a, b, and k are natural numbers.\\r\\n\\r\\n  # Each reduction maintains the invariant\\r\\n  #   mult(acc, a, b) = acc + a * b\\r\\n  # Note that mult's third argument (b) is always decreasing,\\r\\n  # so mult is guaranteed to halt.\\r\\n  # Eventually b reaches 0 and the result is simply the accumulator.\\r\\npositions:\\r\\n  start:  {x: 80 , y: 70}\\r\\n  init:   {x: 190, y: 70}\\r\\n  tidy:   {x: 730, y: 70}\\r\\n  done:   {x: 730, y: 180}\\r\\n\\r\\n  right:  {x: 300, y: 115}\\r\\n  shift:  {x: 600, y: 115}\\r\\n  shift1: {x: 450, y: 70}\\r\\n  shift0: {x: 450, y: 160}\\r\\n\\r\\n  readB:  {x: 300, y: 215}\\r\\n  addA:   {x: 160, y: 215}\\r\\n  doubleL: {x: 550, y: 215}\\r\\n\\r\\n  rewrite: {x: 363, y: 300}\\r\\n  double: {x: 650, y: 300}\\r\\n\\r\\n  back0:  {x: 160, y: 370}\\r\\n  read:   {x: 300, y: 370}\\r\\n  back1:  {x: 440, y: 370}\\r\\n  carry:  {x: 540, y: 370}\\r\\n\\r\\n  add0:   {x:  60, y: 470}\\r\\n  have0:  {x: 200, y: 470}\\r\\n  have1:  {x: 400, y: 470}\\r\\n  add1:   {x: 540, y: 470}\\r\\n\"\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/raw-loader!./src/examples/binaryMult.yaml\n// module id = 29\n// module chunks = 1","module.exports = \"name: 3-state busy beaver\\r\\nsource code: |\\r\\n  input: ''\\r\\n  blank: '0'\\r\\n  start state: A\\r\\n  table:\\r\\n    A:\\r\\n      '0':\\r\\n        write: 1\\r\\n        R: B\\r\\n      '1':\\r\\n        L: C\\r\\n    B:\\r\\n      '0':\\r\\n        write: 1\\r\\n        L: A\\r\\n      '1': R\\r\\n    C:\\r\\n      '0':\\r\\n        write: 1\\r\\n        L: B\\r\\n      '1':\\r\\n        R: H\\r\\n    H: {}\\r\\n  \\r\\n  \\r\\n  # A 3-state 2-symbol busy beaver for most non-blank symbols.\\r\\n  # It takes 13 steps and leaves 6 non-blank symbols on the tape.\\r\\n\\r\\n  # What's a \\\"busy beaver\\\"?\\r\\n  #   Suppose every possible Turing machine with n states and k symbols\\r\\n  #   (for instance, 3 states and 2 symbols) were started on\\r\\n  #   a blank tape with no input.\\r\\n  #   Some of the machines would never halt. Out of the ones that do halt,\\r\\n  #   a machine that leaves the most non-blank symbols on the tape\\r\\n  #   is called a busy beaver.\\r\\n\\r\\n  # An alternative criterion is halting after the most steps.\\r\\n  # This busy beaver takes the most steps (21) but only prints 5 1's:\\r\\n    # A:\\r\\n    #   0: {write: 1, R: B}\\r\\n    #   1: {R: H}\\r\\n    # B:\\r\\n    #   0: {write: 1, L: B}\\r\\n    #   1: {write: 0, R: C}\\r\\n    # C:\\r\\n    #   0: {write: 1, L}\\r\\n    #   1: {L: A}\\r\\n    # H: {}\\r\\n\\r\\n\\r\\n  # Exercise:\\r\\n\\r\\n  # • Consider Turing machines that have n states and k symbols.\\r\\n  #   Instead of a missing instruction, halting is denoted by\\r\\n  #   a transition to a special \\\"halt\\\" state (for a total of n+1 states).\\r\\n  #   How many different transition functions are possible?\\r\\n\\r\\n  #   Hint: Each instruction writes a symbol, moves left or right,\\r\\n  #   and goes to a state.\\r\\n  #   There is one instruction per combination of non-halt state & symbol.\\r\\n\\r\\n\\r\\n\\r\\n  #   Answer: (2k(n+1))^(nk)\\r\\npositions:\\r\\n  A: {x: 320, y: 300}\\r\\n  B: {x: 400, y: 156}\\r\\n  C: {x: 480, y: 300}\\r\\n  H: {x: 400, y: 376}\\r\\n\"\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/raw-loader!./src/examples/busyBeaver3.yaml\n// module id = 30\n// module chunks = 1","module.exports = \"name: 4-state busy beaver\\r\\nsource code: |\\r\\n  blank: 0\\r\\n  start state: A\\r\\n  table:\\r\\n    A:\\r\\n      '0':\\r\\n        write: 1\\r\\n        R: B\\r\\n      '1':\\r\\n        L: B\\r\\n    B:\\r\\n      '0':\\r\\n        write: 1\\r\\n        L: A\\r\\n      '1':\\r\\n        write: 0\\r\\n        L: C\\r\\n    C:\\r\\n      '0':\\r\\n        write: 1\\r\\n        R: H\\r\\n      '1':\\r\\n        L: D\\r\\n    D:\\r\\n      '0':\\r\\n        write: 1\\r\\n        R: D\\r\\n      '1':\\r\\n        write: 0\\r\\n        R: A\\r\\n    H: {}\\r\\n\\r\\n\\r\\n  # A 4-state 2-symbol busy beaver\\r\\n  # that halts after 107 steps, leaving 13 1's on the tape.\\r\\n  # It takes the most steps *and* prints the most 1's.\\r\\n\\r\\n  # Finding a busy beaver requires considering every n-state k-symbol\\r\\n  # machine and proving either that it halts with no more non-blank symbols\\r\\n  # or that it never halts at all.\\r\\n\\r\\n  # Even with strategies to reduce the search space—\\r\\n  # including normalization, accelerated simulation, and automated proofs—\\r\\n  # there are still machines that show surprising complexity\\r\\n  # and require individual analysis.\\r\\n\\r\\n  # This 4-state busy beaver was proven by Allen Brady in 1983.\\r\\n  # Busy beavers for 5 states and above are as yet unknown.\\r\\n  # At the time of writing, the current 5-state 2-symbol contender\\r\\n  # takes 47,176,870 steps to halt, and the 6-state contender\\r\\n  # takes over 7.4 * 10^36534 steps\\r\\n  # (http://www.logique.jussieu.fr/~michel/bbc.html).\\r\\n  # \\\"Given that 5-state 2-symbol halting Turing machines can compute\\r\\n  # Collatz-like congruential functions, it may be very hard to find\\r\\n  # [the next busy beaver]\\\" (https://oeis.org/A060843).\\r\\n\\r\\n\\r\\n  # An entertaining read on busy beavers and their profoundness:\\r\\n\\r\\n  # • \\\"Who Can Name the Bigger Number?\\\"\\r\\n  #   http://www.scottaaronson.com/writings/bignumbers.html\\r\\npositions:\\r\\n  # square with side length 160\\r\\n  A: {x: 320, y: 170}\\r\\n  B: {x: 480, y: 170}\\r\\n\\r\\n  C: {x: 480, y: 330}\\r\\n  D: {x: 320, y: 330}\\r\\n  H: {x: 620, y: 330}\\r\\n\"\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/raw-loader!./src/examples/busyBeaver4.yaml\n// module id = 31\n// module chunks = 1","module.exports = \"name: copy 1s\\r\\nsource code: |\\r\\n  input: '111'\\r\\n  blank: 0\\r\\n  start state: each\\r\\n  table:\\r\\n    each:\\r\\n      '0':\\r\\n        R: H\\r\\n      '1':\\r\\n        write: 0\\r\\n        R: sep\\r\\n    sep:\\r\\n      '0':\\r\\n        R: add\\r\\n      '1': R\\r\\n    add:\\r\\n      '0':\\r\\n        write: 1\\r\\n        L: sepL\\r\\n      '1': R\\r\\n    sepL:\\r\\n      '0':\\r\\n        L: next\\r\\n      '1': L\\r\\n    next:\\r\\n      '0':\\r\\n        write: 1\\r\\n        R: each\\r\\n      '1': L\\r\\n    H: {}\\r\\n\\r\\n\\r\\n  # Copies a string of consecutive 1s.\\r\\n  \\r\\n  # Steps:\\r\\n  # mark the current 1 by erasing it\\r\\n  # skip to the separator\\r\\n  # skip to the end of the copy and write a 1\\r\\n  # return to the separator\\r\\n  # return to the erased 1, restore it, and then advance to the next 1\\r\\n\\r\\n  # Exercises:\\r\\n\\r\\n  # • Edit the machine to copy the string indefinitely,\\r\\n  #   i.e. given the input '11', produce 11011011011...\\r\\n  #   Hint: this can be done by modifying only one transition.\\r\\n\\r\\n  # • Make a machine to output the endless sequence 1011011101111011111...\\r\\npositions:\\r\\n  each: {x: 400, y: 100}\\r\\n  sep:  {x: 400, y: 250}\\r\\n  add:  {x: 400, y: 400}\\r\\n  sepL: {x: 250, y: 250}\\r\\n  next: {x: 250, y: 100}\\r\\n  H:    {x: 550, y: 100}\\r\\n\"\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/raw-loader!./src/examples/copy1s.yaml\n// module id = 32\n// module chunks = 1","module.exports = \"name: divisible by 3\\r\\nsource code: |\\r\\n  input: '1001'\\r\\n  blank: _\\r\\n  start state: q0\\r\\n  table:\\r\\n    q0:\\r\\n      '0': R\\r\\n      '1':\\r\\n        R: q1\\r\\n      _:\\r\\n        R: accept\\r\\n    q1:\\r\\n      '0':\\r\\n        R: q2\\r\\n      '1':\\r\\n        R: q0\\r\\n    q2:\\r\\n      '0':\\r\\n        R: q1\\r\\n      '1':\\r\\n        R: q2\\r\\n    accept: {}\\r\\n  \\r\\n  \\r\\n  # Checks if a binary number is divisible by 3.\\r\\n  # try '1111' (15), '10100' (20), '111001' (57)\\r\\n  \\r\\n  # How it works:\\r\\n\\r\\n  # Consider reading a binary number, say 10011 (19),\\r\\n  # from left to right one digit at a time.\\r\\n  # Each time a digit is read, the new value equals the new digit\\r\\n  # plus the old value shifted left one place (multiplied by 2).\\r\\n\\r\\n  # Digits  Value\\r\\n  # -------------\\r\\n  #         0\\r\\n  # 1       1\\r\\n  # 10      2\\r\\n  # 100     4\\r\\n  # 1001    9\\r\\n  # 10011   19\\r\\n\\r\\n  # Now instead of tracking the entire number, just track the remainder.\\r\\n  # It works the same way.\\r\\n\\r\\n  # Exercises:\\r\\n\\r\\n  # • Modify the machine to check if n-1 is divisible by 3,\\r\\n  #   where n is the input. That is, accept the binary of 1, 4, 7, 10, ...\\r\\n  #   Hint: this can be done without modifying the tape (no 'write').\\r\\n\\r\\n  # • Round the number up to the nearest multiple of 3.\\r\\n  #   Hint: do one pass right to find the remainder, then another pass left\\r\\n  #   to add. See the 'binary increment' example for how to add.\\r\\n\\r\\n  # • Round the number down to the nearest multiple of 3.\\r\\npositions:\\r\\n  q0: {x: 230, y: 250}\\r\\n  q1: {x: 400, y: 250}\\r\\n  q2: {x: 570, y: 250}\\r\\n  accept: {x: 230, y: 380}\\r\\n\"\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/raw-loader!./src/examples/divisibleBy3.yaml\n// module id = 33\n// module chunks = 1","module.exports = \"name: divisible by 3 (base 10)\\r\\nsource code: |\\r\\n  input: '4728'\\r\\n  blank: _\\r\\n  start state: q0\\r\\n  table:\\r\\n    q0:\\r\\n      '0,3,6,9': R\\r\\n      '1,4,7':\\r\\n        R: q1\\r\\n      '2,5,8':\\r\\n        R: q2\\r\\n      _:\\r\\n        R: accept\\r\\n    q1:\\r\\n      '0,3,6,9': R\\r\\n      '1,4,7':\\r\\n        R: q2\\r\\n      '2,5,8':\\r\\n        R: q0\\r\\n    q2:\\r\\n      '0,3,6,9': R\\r\\n      '1,4,7':\\r\\n        R: q0\\r\\n      '2,5,8':\\r\\n        R: q1\\r\\n    accept: {}\\r\\n  \\r\\n  \\r\\n  # Checks if a base 10 number is divisible by 3.\\r\\n  # try 42, 57, 1337, 5328, 7521, 314159265\\r\\n  \\r\\n  # This uses the same idea as the base 2 version.\\r\\n  #\\r\\n  # To make things more interesting, we derive the step relation:\\r\\n  # Let x be the number left of the tape head,\\r\\n  #     d the digit under the head, and\\r\\n  #     x' the number up to and including the head.\\r\\n  # Then\\r\\n  #   x' = 10x + d .\\r\\n  # Notice 10 ≡ 1 (mod 3). Therefore\\r\\n  #   x' ≡ x + d (mod 3) .\\r\\n  # Each step simply adds the new digit's remainder mod 3.\\r\\n  \\r\\n  # Exercises:\\r\\n\\r\\n  # • Check for divisibility by 5.\\r\\n  #   Hint: only 2 states (besides accept) are required.\\r\\n\\r\\n  # • Check for divisibility by 4.\\r\\n  #   Hint: use 4 states (besides accept).\\r\\npositions:\\r\\n  # centered equilateral triangle with side length 250\\r\\n  q0: {x: 275, y: 322}\\r\\n  q1: {x: 400, y: 105}\\r\\n  q2: {x: 525, y: 322}\\r\\n  accept: {x: 275, y: 430}\\r\\n\"\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/raw-loader!./src/examples/divisibleBy3Base10.yaml\n// module id = 34\n// module chunks = 1","module.exports = \"name: multiplied lengths\\r\\nsource code: |\\r\\n  input: aabbbcccccc\\r\\n  blank: _\\r\\n  start state: start\\r\\n  table:\\r\\n    start:\\r\\n      a:\\r\\n        R: a+\\r\\n    a+:\\r\\n      a: R\\r\\n      b:\\r\\n        R: b+\\r\\n    b+:\\r\\n      b: R\\r\\n      c:\\r\\n        R: c+\\r\\n    c+:\\r\\n      c: R\\r\\n      _:\\r\\n        L: left\\r\\n    left:\\r\\n      'a,b,c': L\\r\\n      _:\\r\\n        R: eachA\\r\\n    eachA:\\r\\n      a:\\r\\n        write: _\\r\\n        R: eachB\\r\\n      b:\\r\\n        R: scan\\r\\n    eachB:\\r\\n      a: R\\r\\n      b:\\r\\n        write: B\\r\\n        R: markC\\r\\n      C:\\r\\n        L: nextA\\r\\n    markC:\\r\\n      'b,C': R\\r\\n      c:\\r\\n        write: C\\r\\n        L: nextB\\r\\n    nextB:\\r\\n      'b,C': L\\r\\n      B:\\r\\n        R: eachB\\r\\n    nextA:\\r\\n      a: L\\r\\n      B:\\r\\n        write: b\\r\\n        L: nextA\\r\\n      _:\\r\\n        R: eachA\\r\\n    scan:\\r\\n      'b,C': R\\r\\n      _:\\r\\n        R: accept\\r\\n    accept: {}\\r\\n\\r\\n  \\r\\n  # Decides the language { a^(i)b^(j)c^(k) | i*j = k and i,j,k ≥ 1 }.\\r\\n  # (a's followed by b's then c's,\\r\\n  # where the number of a's multiplied by the number of b's\\r\\n  # equals the number of c's.)\\r\\n  \\r\\n  # Check for the form a^(i)b^(j)c^(k) where i,j,k ≥ 1.\\r\\n  # Then check that i*j = k.\\r\\n  #   The approach is two nested loops:\\r\\n  #   For each 'a':\\r\\n  #     For each 'b':\\r\\n  #       Mark one 'c'\\r\\n  #   At the end, check that all c's are marked.\\r\\n\\r\\npositions:\\r\\n  start:  {x: 180, y: 40}\\r\\n  a+:     {x: 180, y: 180}\\r\\n  b+:     {x: 180, y: 320}\\r\\n  c+:     {x: 180, y: 460}\\r\\n  left:   {x: 290, y: 320}\\r\\n\\r\\n  accept: {x: 400, y: 40}\\r\\n  eachA:  {x: 400, y: 180}\\r\\n  eachB:  {x: 400, y: 320}\\r\\n  markC:  {x: 400, y: 460}\\r\\n\\r\\n  scan:   {x: 560, y: 180}\\r\\n  nextA:  {x: 560, y: 320}\\r\\n  nextB:  {x: 560, y: 460}\\r\\n\"\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/raw-loader!./src/examples/lengthMult.yaml\n// module id = 35\n// module chunks = 1","module.exports = \"name: equal strings\\r\\nsource code: |\\r\\n  input: 01001#01001\\r\\n  blank: _\\r\\n  start state: start\\r\\n  table:\\r\\n    start:\\r\\n      '0':\\r\\n        write: _\\r\\n        R: have0\\r\\n      '1':\\r\\n        write: _\\r\\n        R: have1\\r\\n      '#':\\r\\n        R: check\\r\\n    have0:\\r\\n      '0,1': R\\r\\n      '#':\\r\\n        R: match0\\r\\n    have1:\\r\\n      '0,1': R\\r\\n      '#':\\r\\n        R: match1\\r\\n    match0:\\r\\n      '0':\\r\\n        write: x\\r\\n        L: back\\r\\n      x: R\\r\\n    match1:\\r\\n      '1':\\r\\n        write: x\\r\\n        L: back\\r\\n      x: R\\r\\n    back:\\r\\n      '0,1,#,x': L\\r\\n      _:\\r\\n        R: start\\r\\n    check:\\r\\n      x: R\\r\\n      _:\\r\\n        R: accept\\r\\n    accept: {}\\r\\n  \\r\\n  \\r\\n  # Decides the language { w#w | w ∈ {0,1}* }\\r\\n  # (two equal binary strings separated by '#')\\r\\n  # Two strings are equal if they are both the empty string,\\r\\n  # or they start with the same symbol and are equal thereafter.\\r\\n\\r\\n  # Exercises:\\r\\n\\r\\n  # • Accept if the second string is the bitwise complement\\r\\n  #   (1s and 0s swapped) of the first, e.g. accept '1101#0010'.\\r\\n\\r\\n  # • Check that a binary string has the same number of 0s and 1s;\\r\\n  #   eg., accept '001110' but reject '10010'.\\r\\n\\r\\n  # • Check if two strings are different.\\r\\n  #   Example: accept '00#001' and '0101#0111', but reject '1001#1001'.\\r\\npositions:\\r\\n  accept: {x: 80 , y: 250}\\r\\n  check:  {x: 190, y: 250}\\r\\n  # regular hexagon with side length 150\\r\\n  start:  {x: 300, y: 250}\\r\\n  back:   {x: 600, y: 250}\\r\\n  have1:  {x: 375, y: 120.10}\\r\\n  match1: {x: 525, y: 120.10}\\r\\n  have0:  {x: 375, y: 379.90}\\r\\n  match0: {x: 525, y: 379.90}\\r\\n\"\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/raw-loader!./src/examples/matchBinaryStrings.yaml\n// module id = 36\n// module chunks = 1","module.exports = \"name: three equal lengths\\r\\nsource code: |\\r\\n  input: aabbcc\\r\\n  blank: _\\r\\n  start state: qA\\r\\n  table:\\r\\n    qA:\\r\\n      a:\\r\\n        write: A\\r\\n        R: qB\\r\\n      B:\\r\\n        R: scan\\r\\n    qB:\\r\\n      'a,B': R\\r\\n      b:\\r\\n        write: B\\r\\n        R: qC\\r\\n    qC:\\r\\n      'b,C': R\\r\\n      c:\\r\\n        write: C\\r\\n        L: back\\r\\n    back:\\r\\n      'a,B,b,C': L\\r\\n      A:\\r\\n        R: qA\\r\\n    scan:\\r\\n      'B,C': R\\r\\n      _:\\r\\n        R: accept\\r\\n    accept: {}\\r\\n    \\r\\n  \\r\\n  # Decides the language { aⁿbⁿcⁿ | n ≥ 1 }, that is,\\r\\n  # accepts a's followed by b's then c's of the same length.\\r\\n\\r\\n  # Mark the first a, b, and c on each pass (by capitalizing them).\\r\\n  # All a's must precede all b's, which must precede all c's.\\r\\n  # When there are no more a's,\\r\\n  # all input symbols should have been marked.\\r\\n\\r\\n  # Exercises:\\r\\n\\r\\n  # • Suppose a ledger starts from 0 and gains one dollar for each +\\r\\n  #   and loses one for each -. Reading left to right,\\r\\n  #   check that the account never goes into the negative.\\r\\n  #   Examples: accept '+-++' and '++-+--', reject '-++' and '++---+'.\\r\\n\\r\\n  # • Check parentheses for proper nesting,\\r\\n  #   e.g. accept '()(()()())' but reject '(()))(' and '(()('.\\r\\npositions:\\r\\n  qA: {x: 240, y: 250}\\r\\n  qB: {x: 400, y: 250}\\r\\n  qC: {x: 560, y: 250}\\r\\n  back:   {x: 400, y: 370}\\r\\n  scan:   {x: 320, y: 150}\\r\\n  accept: {x: 480, y: 150}\\r\\n\"\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/raw-loader!./src/examples/matchThreeLengths.yaml\n// module id = 37\n// module chunks = 1","module.exports = \"name: palindrome\\r\\nsource code: |\\r\\n  input: abba\\r\\n  blank: _\\r\\n  start state: start\\r\\n  synonyms:\\r\\n    accept:\\r\\n      R: accept\\r\\n    reject:\\r\\n      R: reject\\r\\n  table:\\r\\n    start:\\r\\n      a:\\r\\n        write: _\\r\\n        R: haveA\\r\\n      b:\\r\\n        write: _\\r\\n        R: haveB\\r\\n      _: accept\\r\\n    haveA:\\r\\n      'a,b': R\\r\\n      _:\\r\\n        L: matchA\\r\\n    haveB:\\r\\n      'a,b': R\\r\\n      _:\\r\\n        L: matchB\\r\\n    matchA:\\r\\n      a:\\r\\n        write: _\\r\\n        L: back\\r\\n      b: reject\\r\\n      _: accept\\r\\n    matchB:\\r\\n      a: reject\\r\\n      b:\\r\\n        write: _\\r\\n        L: back\\r\\n      _: accept\\r\\n    back:\\r\\n      'a,b': L\\r\\n      _:\\r\\n        R: start\\r\\n    accept: {}\\r\\n    reject: {}\\r\\n    \\r\\n  \\r\\n  # Accepts palindromes made of the symbols 'a' and 'b'\\r\\n  # A palindrome is either the empty string, a single symbol,\\r\\n  # or a (shorter) palindrome with the same symbol added to both ends.\\r\\n\\r\\n  # Exercise:\\r\\n\\r\\n  # • Modify the machine to include 'c' in the symbol alphabet,\\r\\n  #   so it also works for strings like 'cabbac'.\\r\\npositions:\\r\\n  haveA:  {x: 240, y: 185}\\r\\n  start:  {x: 400, y: 185}\\r\\n  haveB:  {x: 560, y: 185}\\r\\n\\r\\n  matchA: {x: 240, y: 315}\\r\\n  back:   {x: 400, y: 315}\\r\\n  matchB: {x: 560, y: 315}\\r\\n\\r\\n  accept: {x: 400, y: 55}\\r\\n  reject: {x: 400, y: 445}\\r\\n\"\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/raw-loader!./src/examples/palindrome.yaml\n// module id = 38\n// module chunks = 1","module.exports = \"name: powers of two\\r\\nsource code: |\\r\\n  input: '0000'\\r\\n  blank: _\\r\\n  start state: zero\\r\\n  synonyms:\\r\\n    accept:\\r\\n      R: accept\\r\\n    reject:\\r\\n      R: reject\\r\\n  table:\\r\\n    zero:\\r\\n      '0':\\r\\n        write: _\\r\\n        R: one\\r\\n      _: reject\\r\\n    one:\\r\\n      '0':\\r\\n        write: x\\r\\n        R: even\\r\\n      x: R\\r\\n      _: accept\\r\\n    even:\\r\\n      '0':\\r\\n        R: odd\\r\\n      x: R\\r\\n      _:\\r\\n        L: back\\r\\n    odd:\\r\\n      '0':\\r\\n        write: x\\r\\n        R: even\\r\\n      x: R\\r\\n      _: reject\\r\\n    back:\\r\\n      '0,x': L\\r\\n      _:\\r\\n        R: one\\r\\n    accept: {}\\r\\n    reject: {}\\r\\n\\r\\n  \\r\\n  # Matches strings of 0s whose length is a power of two.\\r\\n\\r\\n    # This example comes from the textbook\\r\\n    #   \\\"Introduction to the Theory of Computation\\\" (3rd edition, 2012)\\r\\n    #   by Michael Sipser\\r\\n    # The states have been renamed (from q1, q2, etc.)\\r\\n    # to make it easier to understand.\\r\\n  \\r\\n  # The idea: divide the length by 2 repeatedly until it reaches 1.\\r\\n\\r\\n  # To do this, cross off every other 0, one pass at a time.\\r\\n  # If any pass reads an odd number of 0s (a remainder), reject right away.\\r\\n  # Otherwise if every pass halves the length cleanly,\\r\\n  # the length must be a power of two (1*2^n for n ≥ 0).\\r\\n\\r\\n  # Note that since the first 0 is never crossed off, we can simply\\r\\n  # erase it on the first pass and start the count from 1 from then on.\\r\\n\\r\\npositions:\\r\\n  zero:   {x: 200, y: 200}\\r\\n  one:    {x: 400, y: 200}\\r\\n  even:   {x: 600, y: 200}\\r\\n\\r\\n  odd:    {x: 600, y: 385}\\r\\n  back:   {x: 500, y: 125}\\r\\n  accept: {x: 400, y: 300}\\r\\n  reject: {x: 200, y: 385}\\r\\n\"\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/raw-loader!./src/examples/powersOfTwo.yaml\n// module id = 39\n// module chunks = 1","module.exports = \"name: repeat 0 1\\r\\nsource code: |\\r\\n  input: ''\\r\\n  blank: _\\r\\n  start state: b\\r\\n  table:\\r\\n    b:\\r\\n      _:\\r\\n        write: 0\\r\\n        R: c\\r\\n    c:\\r\\n      _:\\r\\n        R: e\\r\\n    e:\\r\\n      _:\\r\\n        write: 1\\r\\n        R: f\\r\\n    f:\\r\\n      _:\\r\\n        R: b\\r\\n\\r\\n\\r\\n  # This is the first example machine given by Alan Turing in his 1936 paper\\r\\n  #   \\\"On Computable Numbers, with an Application to\\r\\n  #    the Entscheidungsproblem\\\".\\r\\n  # It simply writes the endless sequence 0 1 0 1 0 1...\\r\\n\\r\\n  # (Turing uses the convention of leaving a gap after each output cell,\\r\\n  # reserving it for marking the cell. For instance, on a tape that\\r\\n  # contains '0 1x0 0 1 1y1y0y', x marks the leftmost 1 and y marks 110.)\\r\\npositions:\\r\\n  b: {x: 300, y: 200}\\r\\n  c: {x: 450, y: 150}\\r\\n  e: {x: 500, y: 300}\\r\\n  f: {x: 350, y: 350}\\r\\n\"\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/raw-loader!./src/examples/repeat01.yaml\n// module id = 40\n// module chunks = 1","module.exports = \"name: unary multiplication\\r\\nsource code: |\\r\\n  input: '||*|||'\\r\\n  blank: _\\r\\n  start state: eachA\\r\\n  table:\\r\\n    eachA:\\r\\n      '|':\\r\\n        write: _\\r\\n        R: toB\\r\\n      '*':\\r\\n        R: skip\\r\\n    toB:\\r\\n      '|': R\\r\\n      '*':\\r\\n        R: eachB\\r\\n    nextA:\\r\\n      '|,*': L\\r\\n      _:\\r\\n        write: '|'\\r\\n        R: eachA\\r\\n    skip:\\r\\n      '|': R\\r\\n      _:\\r\\n        R: done\\r\\n    done: {}\\r\\n    eachB:\\r\\n      '|':\\r\\n        write: _\\r\\n        R: sep\\r\\n      _:\\r\\n        L: nextA\\r\\n    sep:\\r\\n      '|': R\\r\\n      _:\\r\\n        R: add\\r\\n    add:\\r\\n      '|': R\\r\\n      _:\\r\\n        write: '|'\\r\\n        L: sepL\\r\\n    sepL:\\r\\n      '|': L\\r\\n      _:\\r\\n        L: nextB\\r\\n    nextB:\\r\\n      '|': L\\r\\n      _:\\r\\n        write: '|'\\r\\n        R: eachB\\r\\n\\r\\n  \\r\\n  # Multiplies together two unary numbers separated by a '*'.\\r\\n  # (Unary is like tallying. Here '||*|||' means 2 times 3.)\\r\\n  \\r\\n  # The idea:\\r\\n  #   multiply(0, b) = 0\\r\\n  #   multiply(a, b) = b + multiply(a-1, b)   when a > 0\\r\\n  \\r\\n  # This machine directly utilises the 'copy 1s' machine:\\r\\n  # For each 1 in a, add a copy of b.\\r\\n\\r\\npositions:\\r\\n  eachA:  {x: 400, y:  50}\\r\\n  toB:    {x: 400, y: 150}\\r\\n  eachB:  {x: 400, y: 250}\\r\\n  sep:   {x: 400, y: 350}\\r\\n  add:   {x: 400, y: 450}\\r\\n\\r\\n  sepL:  {x: 280, y: 350}\\r\\n  nextB:  {x: 280, y: 250}\\r\\n\\r\\n  nextA:  {x: 280, y: 90}\\r\\n  skip:   {x: 520, y: 90}\\r\\n  done:   {x: 520, y: 190}\\r\\n\"\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/raw-loader!./src/examples/unaryMult.yaml\n// module id = 41\n// module chunks = 1","module.exports = jQuery;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"jQuery\"\n// module id = 42\n// module chunks = 1","'use strict';\r\n\r\n/* eslint-env browser */\r\nvar CheckboxTable = require('./CheckboxTable');\r\nvar FileReaderPromise = require('./FileReaderPromise');\r\nvar format = require('./format');\r\nvar getGist = require('./gist').getGist;\r\n\r\nvar $ = require('jquery');\r\nvar _ = require('lodash/fp');\r\nvar d3 = require('d3');\r\nvar Promise = require('bluebird');  // eslint-disable-line no-shadow\r\n\r\n\r\nfunction decodeFormURLComponent(str) {\r\n  return decodeURIComponent(str.replace('+', ' '));\r\n}\r\n\r\n/**\r\n * https://url.spec.whatwg.org/#urlencoded-parsing\r\n */\r\nfunction queryParams(queryString) {\r\n  function decode(str) {\r\n    return str ? decodeFormURLComponent(str) : '';\r\n  }\r\n  var result = {};\r\n  queryString.split('&').forEach(function (str) {\r\n    var pair = str.split('=');\r\n    result[decode(pair[0])] = decode(pair[1]);\r\n  });\r\n  return result;\r\n}\r\n\r\n///////////////////\r\n// Import Dialog //\r\n///////////////////\r\n\r\n// requires an existing dialog in the DOM\r\nfunction ImportDialog(dialogNode) {\r\n  this.node = dialogNode;\r\n  this.titleNode = dialogNode.querySelector('.modal-header .modal-title');\r\n  this.bodyNode = dialogNode.querySelector('.modal-body');\r\n  this.footerNode = dialogNode.querySelector('.modal-footer');\r\n  this.cancelButtonNode = d3.select(this.footerNode).text('')\r\n    .append('button')\r\n      .attr({type: 'button', class: 'btn btn-default', 'data-dismiss': 'modal'})\r\n      .text('Cancel')\r\n    .node();\r\n  this.$dialog = $(dialogNode)\r\n    .one('hide.bs.modal', this.__onClose.bind(this));\r\n}\r\n\r\n// internal event handler.\r\nImportDialog.prototype.__onClose = function () {\r\n  this.onClose();\r\n  // use .empty to clean up $.on used in CheckboxTable\r\n  $(this.bodyNode).empty();\r\n  $(this.footerNode).empty();\r\n};\r\n\r\n// configurable\r\nImportDialog.prototype.onClose = function () {\r\n};\r\n\r\nImportDialog.prototype.show = function () {\r\n  this.$dialog.modal({backdrop: 'static', keyboard: false});\r\n};\r\n\r\nImportDialog.prototype.close = function () {\r\n  this.$dialog.modal('hide');\r\n};\r\n\r\nImportDialog.prototype.setBodyChildNodes = function (nodes) {\r\n  this.bodyNode.textContent = '';\r\n  this.bodyNode.appendChild(joinNodes(nodes));\r\n};\r\n\r\nfunction appendPanel(div, titleHTML) {\r\n  var panel = div.append('div')\r\n      .attr('class', 'panel panel-default');\r\n  panel.append('div')\r\n      .attr('class', 'panel-heading')\r\n    .append('h5')\r\n      .attr('class', 'panel-title')\r\n      .html(titleHTML);\r\n  return panel;\r\n}\r\n\r\nvar emptySelection = Object.freeze(d3.selectAll([]));\r\n\r\n// (D3Selection, {title: string, data: [string]}) -> void\r\nfunction appendListPanel(container, data) {\r\n  var panel = emptySelection;\r\n  if (data.data && data.data.length) {\r\n    panel = appendPanel(container, data.title);\r\n    panel.append('div')\r\n        .attr('class', 'panel-body')\r\n      .append('ul')\r\n        .attr('class', 'list-inline')\r\n      .selectAll('li')\r\n        .data(data.data)\r\n      .enter().append('li')\r\n        .text(_.identity);\r\n  }\r\n  return panel;\r\n}\r\n\r\n// ( D3Selection, {title: string, headers: [string],\r\n//  data: [[string | (D3Selection -> void)]]} ) -> void\r\nfunction appendTablePanel(container, data) {\r\n  var panel = emptySelection;\r\n  if (data.data && data.data.length) {\r\n    panel = appendPanel(container, data.title);\r\n    panel.append('table')\r\n        .attr('class', 'table')\r\n        .call(function (table) {\r\n          // headers\r\n          table.append('thead')\r\n            .append('tr').selectAll('th').data(data.headers)\r\n            .enter().append('th').text(_.identity);\r\n          // contents\r\n          table.append('tbody').selectAll('tr')\r\n              .data(data.data)\r\n            .enter().append('tr').selectAll('td')\r\n              .data(_.identity)\r\n            .enter().append('td').each(/* @this td */ function (d) {\r\n              var td = d3.select(this);\r\n              if (typeof d === 'function') {\r\n                d(td);\r\n              } else {\r\n                td.text(d);\r\n              }\r\n            });\r\n        });\r\n  }\r\n  return panel;\r\n}\r\n\r\n// NonDocumentFiles -> boolean\r\nvar isEmptyNonDocs = _.every(_.isEmpty);\r\n\r\n// (D3Selection, NonDocumentFiles, ?string) -> void\r\nfunction listNondocuments(dialogBody, nondocs, disclosureTitle) {\r\n  if (isEmptyNonDocs(nondocs)) {\r\n    return;\r\n  }\r\n  // Disclosure triangle\r\n  var collapseId = 'nondocument-files';\r\n  dialogBody.append('a')\r\n      .attr({\r\n        href: '#'+collapseId,\r\n        class: 'disclosure-triangle collapsed',\r\n        role: 'button',\r\n        'data-toggle': 'collapse'\r\n      })\r\n      .text(disclosureTitle ? disclosureTitle : 'Show other files');\r\n  var container = dialogBody.append('div')\r\n      .attr({\r\n        id: collapseId,\r\n        class: 'collapse'\r\n      });\r\n  // Errors by type, most important first\r\n  appendTablePanel(container, {\r\n    title: 'Unexpected error',\r\n    headers: ['Filename', 'Error'],\r\n    data: nondocs.otherError.map(function functionName(d) {\r\n      return [d.filename, errorString(d.error) ];\r\n    })\r\n  }).classed('panel-danger', true);\r\n  appendTablePanel(container, {\r\n    title: 'Not suitable for import',\r\n    headers: ['Filename', 'Reason'],\r\n    data: nondocs.badDoc.map(function (d) {\r\n      return [d.filename, d.error.message];\r\n    })\r\n  });\r\n  appendTablePanel(container, {\r\n    title: 'Not valid as YAML',\r\n    headers: ['Filename', 'Syntax error'],\r\n    data: nondocs.badYAML.map(function (d) {\r\n      return [d.filename,\r\n        function (td) { td.append('pre').text(d.error.message); } ];\r\n    })\r\n  });\r\n  // TODO: document largest allowed filesize; limit export likewise\r\n  appendListPanel(container, {\r\n    title: 'File is too large',\r\n    data: nondocs.tooLarge\r\n  });\r\n  appendListPanel(container, {\r\n    title: 'Different file extension (not <code>.yaml</code>/<code>.yml</code>)',\r\n    data: nondocs.wrongType\r\n  });\r\n}\r\n\r\n// deal with objects like DOMError (whose .toString gives \"[object FileError]\")\r\nfunction errorString(reason) {\r\n  return reason instanceof Error\r\n    ? String(reason)\r\n    : reason.message || reason.name || String(reason);\r\n}\r\n\r\n//////////////////////\r\n// Document Parsing //\r\n//////////////////////\r\n\r\n/* Interface for Document Parsing\r\n  type GistFile = {\r\n    filename: string,\r\n    size: number,\r\n    truncated: boolean,\r\n    content: string\r\n  };\r\n  type TMData = {source code: string};\r\n  type DocFile = {filename: string, size: number, document: TMData};\r\n\r\n  type Filename = string;\r\n  type ErrorTuple = {filename: Filename, error: Error | YAMLException};\r\n  type NonDocumentFiles = {\r\n    wrongType:  [Filename],\r\n    tooLarge:   [Filename],\r\n    badYAML:    [ErrorTuple],\r\n    badDoc:     [ErrorTuple],\r\n    otherError: [ErrorTuple]\r\n  };\r\n  type ParseResult = {documentFiles: [DocFile], nonDocumentFiles: NonDocumentFiles};\r\n */\r\n\r\n// Parse each file into a document or a categorized error.\r\n// Local files are read only if they have the right extension and size.\r\n// NB. make sure to convert FileList to an actual Array.\r\n// The promise resolves with ParseResult.\r\n// (number, [GistFile | File]) -> Promise\r\nfunction parseFiles(sizelimit, files) {\r\n  var docfiles = [];\r\n  var nondocs = {wrongType: [], tooLarge: [], badYAML: [], badDoc: [], otherError: []};\r\n\r\n  return Promise.each(files, function (file) {\r\n    var name = file.filename || file.name; // eslint-disable-line no-shadow\r\n    if (name.search(/\\.ya?ml$/) === -1) {\r\n      nondocs.wrongType.push(name);\r\n    } else if (file.truncated || file.size > sizelimit) {\r\n      nondocs.tooLarge.push(name);\r\n    } else {\r\n      return Promise.resolve(file.content != null ? file.content\r\n        : FileReaderPromise.readAsText(file))\r\n      .then(function (content) {\r\n        docfiles.push({\r\n          filename: name,\r\n          size: file.size,\r\n          document: format.parseDocument(content)\r\n        });\r\n      }).catch(function (e) {\r\n        var tuple = {filename: name, error: e};\r\n        if (e instanceof format.YAMLException) {\r\n          nondocs.badYAML.push(tuple);\r\n        } else if (e instanceof format.InvalidDocumentError) {\r\n          nondocs.badDoc.push(tuple);\r\n        } else {\r\n          nondocs.otherError.push(tuple);\r\n        }\r\n      });\r\n    }\r\n  }).return({documentFiles: docfiles, nonDocumentFiles: nondocs});\r\n}\r\n\r\n/////////////////////\r\n// Document Import //\r\n/////////////////////\r\n\r\nfunction showSizeKB(n) {\r\n  // example: 12.0 KB\r\n  return (Math.ceil(10*n/1024)/10).toFixed(1) + ' KB';\r\n}\r\n\r\n// {docFiles: [DocFile], nonDocumentFiles: NonDocumentFiles,\r\n//  dialog: ImportDialog, citeNode?: Node, importDocuments: [TMData] -> void} -> void\r\nfunction pickMultiple(args) {\r\n  var docfiles = args.documentFiles,\r\n      nondocs = args.nonDocumentFiles,\r\n      citeNode = args.citeNode,\r\n      dialog = args.dialog,\r\n      importDocuments = args.importDocuments;\r\n  // Dialog body\r\n  var dialogBody = d3.select(dialog.bodyNode).text('');\r\n  dialogBody.append('p').call(function (p) {\r\n    p.append('strong').text('Select documents to import');\r\n    if (citeNode) {\r\n      p.node().appendChild(document.createTextNode(' from '));\r\n      p.node().appendChild(citeNode);\r\n    }\r\n  });\r\n  var ctable = new CheckboxTable({\r\n    table: dialogBody.append('table')\r\n      .attr({class: 'table table-hover checkbox-table'}),\r\n    headers: ['Filename', 'Size'],\r\n    data: docfiles.map(function (doc) {\r\n      return [doc.filename, showSizeKB(doc.size)];\r\n    })\r\n  });\r\n  listNondocuments(dialogBody, nondocs);\r\n  // Dialog footer\r\n  var importButton = d3.select(dialog.footerNode).append('button')\r\n      .attr({type: 'button', class: 'btn btn-primary', 'data-dismiss': 'modal'})\r\n      .property('disabled', true)\r\n      .text('Import')\r\n      .on('click', /* @this button */ function () {\r\n        d3.select(this).on('click', null); // prevent double import; like .one()\r\n        var names = d3.set(ctable.getCheckedValues());\r\n        importDocuments(docfiles\r\n          .filter(function (file) { return names.has(file.filename); })\r\n          .map(_.property('document'))\r\n        );\r\n      })\r\n    .node();\r\n  ctable.onChange = function () {\r\n    importButton.disabled = ctable.isCheckedEmpty();\r\n  };\r\n}\r\n\r\n// {nonDocumentFiles: NonDocumentFiles, dialog: ImportDialog, citeLink?: Node} -> void\r\nfunction pickNone(args) {\r\n  var nondocs = args.nonDocumentFiles,\r\n      dialog = args.dialog,\r\n      citeLink = args.citeLink;\r\n\r\n  d3.select(dialog.bodyNode).text('').call(function (body) {\r\n    body.append('p').append('strong').text(!isEmptyNonDocs(nondocs)\r\n        ? 'None of the files are suitable for import.'\r\n        : 'No files were selected.');\r\n    if (citeLink) {\r\n      body.append('p').text('Requested URL: ').node().appendChild(citeLink);\r\n    }\r\n    listNondocuments(body, nondocs, 'Show details');\r\n  });\r\n  dialog.cancelButtonNode.textContent = 'Close';\r\n}\r\n\r\n// Intermingle text and nodes.\r\n// [Node | string] -> DocumentFragment\r\nfunction joinNodes(nodes) {\r\n  var result = document.createDocumentFragment();\r\n  nodes.forEach(function (node) {\r\n    if (typeof node === 'string') {\r\n      result.appendChild(document.createTextNode(node));\r\n    } else {\r\n      result.appendChild(node);\r\n    }\r\n  });\r\n  return result;\r\n}\r\n\r\nfunction wrapTag(tagName, node) {\r\n  var tag = document.createElement(tagName);\r\n  tag.appendChild(node);\r\n  return tag;\r\n}\r\n\r\n// Create a link with text <q>`gist description`</q> if given, otherwise gist `gistID`.\r\n// {gistID: string, description?: string} -> HTMLAnchorElement | HTMLQuoteElement\r\nfunction gistDescriptionLink(args) {\r\n  var link = externalLink({\r\n    href: 'https://gist.github.com/' + args.gistID,\r\n    textContent: args.description || ('gist ' + args.gistID)\r\n  });\r\n  return args.description ? wrapTag('q', link) : link;\r\n}\r\n\r\n// {href: string, textContent?: string} -> HTMLAnchorElement\r\nfunction externalLink(args) {\r\n  var link = document.createElement('a');\r\n  link.href = args.href;\r\n  link.target = '_blank';\r\n  link.textContent = args.textContent || args.href;\r\n  return link;\r\n}\r\n\r\n// The returned promise resolves/cancels when the dialog is closed:\r\n// • resolves if loading (before import) finished and the user cancelled anyway\r\n// • cancels if files were still loading and not yet displayed (eg. fetch, parse)\r\n// ({gistID: string, dialogNode: Node, importDocument: TMData -> void} |\r\n// {files: FileList, dialogNode: Node, importDocument: TMData -> void}) -> Promise\r\nfunction importCommon(args) {\r\n  var gistID = args.gistID,\r\n      dialogNode = args.dialogNode,\r\n      importDocument = args.importDocument;\r\n\r\n  var dialog = new ImportDialog(dialogNode);\r\n  var citeLink;\r\n  var citeNode;\r\n  // prevent accidentally exceeding quota\r\n  var MAX_FILESIZE = 400 * 1024;\r\n  // Start fetch, show dialog\r\n  var filesPromise = (function () {\r\n    if (gistID != null) {\r\n      dialog.titleNode.textContent = 'Import from GitHub gist';\r\n      citeLink = externalLink({href: 'https://gist.github.com/' + gistID});\r\n      dialog.setBodyChildNodes(['Retrieving ', citeLink, '…']);\r\n      return getGist(gistID).then(function (data) {\r\n        citeNode = gistDescriptionLink({\r\n          gistID: gistID,\r\n          description: data.description\r\n        });\r\n        dialog.setBodyChildNodes(['Processing ', citeLink, '…']);\r\n        return _.values(data.files);\r\n      });\r\n    } else {\r\n      dialog.titleNode.textContent = 'Import from files';\r\n      dialog.setBodyChildNodes(['Processing files…']);\r\n      return Promise.resolve(_.toArray(args.files));\r\n    }\r\n  }());\r\n  dialog.show();\r\n  // Parse, pick, import\r\n  var promise = filesPromise\r\n  .then(parseFiles.bind(undefined, MAX_FILESIZE))\r\n  .then(function (parsed) {\r\n    var docfiles = parsed.documentFiles;\r\n    switch (docfiles.length) {\r\n      case 0:\r\n        pickNone({\r\n          nonDocumentFiles: parsed.nonDocumentFiles,\r\n          dialog: dialog,\r\n          citeLink: citeLink\r\n        });\r\n        return;\r\n      case 1:\r\n        importDocument(docfiles[0].document);\r\n        dialog.close();\r\n        return;\r\n      default:\r\n        pickMultiple({\r\n          documentFiles: docfiles,\r\n          nonDocumentFiles: parsed.nonDocumentFiles,\r\n          dialog: dialog,\r\n          citeNode: citeNode,\r\n          importDocuments: function importDocuments(docs) {\r\n            docs.concat().reverse().map(importDocument);\r\n          }\r\n        });\r\n    }\r\n  })\r\n  .catch(function (reason) {\r\n    dialog.setBodyChildNodes([messageForError(reason)]\r\n      .concat(citeLink ? ['Requested URL: ', citeLink] : [])\r\n    );\r\n    dialog.cancelButtonNode.textContent = 'Close';\r\n  });\r\n  var waitForDialog = new Promise(function (resolve) {\r\n    dialog.onClose = function () {\r\n      promise.cancel();\r\n      resolve();\r\n    };\r\n  });\r\n  return promise.return(waitForDialog);\r\n}\r\n\r\n// {gistID: string, dialogNode: Node, importDocument: TMData -> void} -> Promise\r\nvar importGist = importCommon;\r\n\r\n// {files: FileList, dialogNode: Node, importDocument: TMData -> void} -> Promise\r\nvar importLocalFiles = importCommon;\r\n\r\nfunction createElementHTML(tagName, innerHTML) {\r\n  var element = document.createElement(tagName);\r\n  element.innerHTML = innerHTML;\r\n  return element;\r\n}\r\n\r\n// ({xhr: jqXHR} | Error) -> Node\r\nfunction messageForError(reason) {\r\n  var xhr = reason.xhr;\r\n  if (xhr) {\r\n    // case: couldn't fetch\r\n    return createElementHTML('p', (function () {\r\n      switch (reason.status) {\r\n        case 'abort':\r\n          return [''];\r\n        case 'timeout':\r\n          return [\r\n            '<strong>The request timed out.</strong>',\r\n            'You can check your connection and try again.'\r\n          ];\r\n        default:\r\n        // case: HTTP error\r\n          if (xhr.status === 404) {\r\n            return [\r\n              '<strong>No GitHub gist exists with that ID.</strong>',\r\n              'It’s possible the ID is incorrect, or the gist was deleted.'\r\n            ];\r\n          } else if (xhr.status === 0) {\r\n            return ['GitHub could not be reached. Your Internet connection may be offline.'];\r\n          } else {\r\n            return [\r\n              'The import failed because of a <strong>connection error</strong>.',\r\n              'HTTP status code: ' + xhr.status + ' ' + xhr.statusText\r\n            ];\r\n          }\r\n      }\r\n    }()).join('<br>'));\r\n  } else {\r\n    // case: other error\r\n    var pre = document.createElement('pre');\r\n    pre.textContent = errorString(reason);\r\n    return joinNodes([\r\n      createElementHTML('p', 'An unexpected error occurred:'), pre]);\r\n  }\r\n}\r\n\r\n// Import a gist via ?import-gist=gistID and remove the query string from the URL.\r\n// Call this once the DOM is ready (document.readyState === 'interactive').\r\n// {dialogNode: Node, importDocument: TMData -> void} -> void\r\nfunction runImport(args) {\r\n  function removeQuery() {\r\n    try {\r\n      history.replaceState(null, null, location.pathname);\r\n    } catch (e) {\r\n      // ignore\r\n    }\r\n  }\r\n\r\n  var params = queryParams(location.search.substring(1));\r\n  var gistID = params['import-gist'];\r\n  if (gistID) {\r\n    importGist(_.assign({gistID: gistID}, args))\r\n    .finally(removeQuery);\r\n  }\r\n}\r\n\r\nexports.importGist = importGist;\r\nexports.importLocalFiles = importLocalFiles;\r\nexports.runImport = runImport;\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/sharing/import.js\n// module id = 43\n// module chunks = 1","'use strict';\r\n\r\n// var d3 = require('d3');\r\nvar $ = require('jquery'); // for event delegation\r\n\r\nfunction identity(x) { return x; }\r\nfunction head(array) { return array[0]; }\r\n\r\n/**\r\n * A <table> that includes a checkbox in front of each row,\r\n * and a header checkbox to (de)select all rows.\r\n * @param {D3Selection<HTMLTableElement>} args.table empty table to use\r\n * @param {[string]}    [args.headers] column headers\r\n * @param {[[string]]}  [args.data]    table data\r\n */\r\nfunction CheckboxTable(args) {\r\n  this.table = args.table;\r\n  this.headerRow = this.table.append('thead').append('tr');\r\n  this.tbody = this.table.append('tbody');\r\n  // header checkbox (selects/deselects all checkboxes)\r\n  var self = this;\r\n  this.headerCheckbox = this.headerRow\r\n    .append('th')\r\n      .attr('class', 'checkbox-cell')\r\n    .append('input')\r\n      .attr('type', 'checkbox')\r\n      .on('click', /* @this checkbox */ function () {\r\n        self.getCheckboxes().property('checked', this.checked);\r\n        self.onChange();\r\n      });\r\n  $(this.tbody.node()).on('click', 'tr', /* @this tr */ function (e) {\r\n    // treat whole <tr> as click zone\r\n    if (e.target.tagName !== 'INPUT') {\r\n      var box = this.querySelector('input[type=\"checkbox\"]');\r\n      box.checked = !box.checked;\r\n    }\r\n    // update header checkbox\r\n    self.refresh();\r\n    self.onChange();\r\n  });\r\n  // content\r\n  args.headers && this.setHeaders(args.headers);\r\n  args.data && this.setData(args.data);\r\n}\r\n\r\n/**\r\n * Set the column headers.\r\n * @param {[string]} headers\r\n */\r\nCheckboxTable.prototype.setHeaders = function (headers) {\r\n  var th = this.headerRow\r\n    .selectAll('th:not(.checkbox-cell)')\r\n      .data(headers);\r\n  th.exit().remove();\r\n  th.enter().append('th');\r\n  th.text(identity);\r\n};\r\n\r\n/**\r\n * Set the table body data.\r\n *\r\n * Each row begins with a checkbox whose .value is the first cell.\r\n * Rows are keyed by the first cell when updating data.\r\n * @param {[[string]]} data\r\n * @return this\r\n */\r\nCheckboxTable.prototype.setData = function (data) {\r\n  var tr = this.tbody.selectAll('tr')\r\n      .data(data, head);\r\n  tr.exit().remove();\r\n  tr.enter()\r\n    .append('tr')\r\n  // checkbox at the start of each row\r\n    .append('td')\r\n      .attr('class', 'checkbox-cell')\r\n    .append('input')\r\n      .attr({\r\n        type: 'checkbox',\r\n        value: head\r\n      });\r\n  tr.order();\r\n  // row cells\r\n  var td = tr.selectAll('td:not(.checkbox-cell)')\r\n      .data(identity);\r\n  td.exit().remove();\r\n  td.enter().append('td');\r\n  td.text(identity);\r\n\r\n  return this;\r\n};\r\n\r\nCheckboxTable.prototype.getCheckboxes = function () {\r\n  return this.tbody.selectAll('input[type=\"checkbox\"]');\r\n};\r\n\r\nCheckboxTable.prototype.getCheckedValues = function () {\r\n  return this.tbody.selectAll('input[type=\"checkbox\"]:checked')[0]\r\n    .map(function (x) { return x.value; });\r\n};\r\n\r\nCheckboxTable.prototype.isCheckedEmpty = function () {\r\n  var headerBox = this.headerCheckbox.node();\r\n  return !(headerBox.checked || headerBox.indeterminate);\r\n};\r\n\r\n/**\r\n * Refresh the header checkbox (called after a row checkbox is toggled).\r\n */\r\nCheckboxTable.prototype.refresh = function () {\r\n  var headerBox = this.headerCheckbox.node();\r\n  var boxes = this.getCheckboxes();\r\n\r\n  var total = boxes.size();\r\n  var checked = boxes.filter(':checked').size();\r\n  if (checked === 0) {\r\n    headerBox.checked = false;\r\n  } else if (checked === total) {\r\n    headerBox.checked = true;\r\n  }\r\n  headerBox.indeterminate = (0 < checked && checked < total);\r\n};\r\n\r\n// configurable. called after a click toggles a row or header checkbox.\r\nCheckboxTable.prototype.onChange = function () {\r\n};\r\n\r\nmodule.exports = CheckboxTable;\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/sharing/CheckboxTable.js\n// module id = 44\n// module chunks = 1","'use strict';\r\n\r\n/* global FileReader:false */\r\nvar Promise = require('bluebird'); // eslint-disable-line no-shadow\r\n\r\n// arguments are forwarded to FileReader.readAsText\r\n// (Blob, ?encoding) -> Promise\r\nfunction readAsText() {\r\n  var args = arguments;\r\n  return new Promise(function (resolve, reject, onCancel) {\r\n    var reader = new FileReader();\r\n    reader.addEventListener('load', function () {\r\n      resolve(reader.result);\r\n    });\r\n    reader.addEventListener('error', function () {\r\n      reject(reader.error);\r\n    });\r\n    onCancel && onCancel(function () {\r\n      try { reader.abort(); } catch (e) {/* */}\r\n    });\r\n\r\n    reader.readAsText.apply(reader, args);\r\n  });\r\n}\r\n\r\nexports.readAsText = readAsText;\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/sharing/FileReaderPromise.js\n// module id = 45\n// module chunks = 1","module.exports = Promise;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"Promise\"\n// module id = 46\n// module chunks = 1","'use strict';\r\n\r\nvar $ = require('jquery');\r\nvar Promise = require('bluebird'); // eslint-disable-line no-shadow\r\n\r\nPromise.config({\r\n  cancellation: true\r\n});\r\n\r\n// On success, 'resolve' is called with the response data.\r\n// On failure, 'reject' is called with {xhr: jqXHR, status: string, error: string}.\r\n// To abort the request, use .cancel (from bluebird). Neither is called in that case.\r\n// jqXHR -> Promise\r\nfunction promisifyAjax(xhr) {\r\n  return new Promise(function (resolve, reject, onCancel) {\r\n    xhr.then(resolve, function (jqXHR, textStatus, errorThrown) {\r\n      reject({xhr: jqXHR, status: textStatus, error: errorThrown});\r\n    });\r\n    onCancel && onCancel(function () {\r\n      try { xhr.abort(); } catch (e) {/* */}\r\n    });\r\n  });\r\n}\r\n\r\n// GistID -> Promise\r\n// @see promisifyAjax\r\nfunction getGist(gistID) {\r\n  return promisifyAjax($.ajax({\r\n    url: 'https://api.github.com/gists/' + gistID,\r\n    type: 'GET',\r\n    dataType: 'json',\r\n    accepts: 'application/vnd.github.v3+json' // specify API version for stability\r\n  }));\r\n}\r\n\r\n// https://developer.github.com/v3/gists/#create-a-gist\r\n// @see promisifyAjax\r\n// {files: {[filename: string]: {content: string}},\r\n//  description?: string, public?: boolean} -> Promise\r\nfunction createGist(payload) {\r\n  // return Promise.delay(1000, {id: 'offlinetesting'});\r\n  return promisifyAjax($.ajax({\r\n    url: 'https://api.github.com/gists',\r\n    type: 'POST',\r\n    data: JSON.stringify(payload),\r\n    // headers: {Authorization: 'token DEVTOKEN'},\r\n    dataType: 'json', // response datatype\r\n    accepts: 'application/vnd.github.v3+json' // specify API version for stability\r\n  }));\r\n}\r\n\r\nexports.getGist = getGist;\r\nexports.createGist = createGist;\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/sharing/gist.js\n// module id = 47\n// module chunks = 1","'use strict';\r\n\r\n/* global document: false */\r\nvar docimport = require('./import');\r\nvar format = require('./format');\r\nvar _ = require('lodash/fp');\r\nvar d3 = require('d3');\r\n\r\n// Init the import panel and attach event handlers\r\n// {$dialog: jQuery, gistIDForm: HTMLFormElement, importArgs: Object} -> void\r\nfunction init(args) {\r\n  var $dialog = args.$dialog,\r\n      gistIDForm = args.gistIDForm,\r\n      importArgs = args.importArgs;\r\n\r\n  function hideDialog() {\r\n    $dialog.modal('hide');\r\n    // Workaround needed for opening another modal before a modal is done hiding.\r\n    // Without this, the <body> scrolls instead of the modal:\r\n    // modal2.show locks body scroll => modal1.hidden unlocks body scroll\r\n    // while modal2 is still open.\r\n    var nextDialog = importArgs.dialogNode;\r\n    $dialog.one('hidden.bs.modal', function () {\r\n      if (nextDialog.classList.contains('in')) {\r\n        document.body.classList.add('modal-open');\r\n      }\r\n    });\r\n  }\r\n\r\n  // Panel: From GitHub gist\r\n  gistIDForm.addEventListener('submit', function (e) {\r\n    e.preventDefault();\r\n    hideDialog();\r\n\r\n    var gistID = gistIDForm.querySelector('input[type=\"text\"]').value;\r\n    docimport.importGist(_.assign({gistID: gistID}, importArgs));\r\n  });\r\n\r\n  // Panel: From files\r\n  (function () {\r\n    // TODO: factor out element IDs and containers into interface\r\n    var panelBody = document.querySelector('#importFilesPanel > .panel-body');\r\n    // <input type=\"file\">\r\n    var fileInput = panelBody.querySelector('input[type=\"file\"]');\r\n    var importFilesButton = document.getElementById('importFilesButton');\r\n    importFilesButton.addEventListener('click', function () {\r\n      hideDialog();\r\n      docimport.importLocalFiles(_.assign({files: fileInput.files}, importArgs));\r\n    });\r\n    // <textarea>\r\n    var textarea = panelBody.querySelector('textarea');\r\n    var importContentsButton = document.getElementById('importContentsButton');\r\n    importContentsButton.parentNode.style.position = 'relative';\r\n    importContentsButton.addEventListener('click', function (e) {\r\n      if (importDocumentContents(\r\n        { containers: {status: e.target.parentNode, details: panelBody },\r\n          importDocument: importArgs.importDocument },\r\n        textarea.value\r\n      )) {\r\n        textarea.select();\r\n      }\r\n    });\r\n  }());\r\n}\r\n\r\n///////////////////////////////\r\n// Import from pasted string //\r\n///////////////////////////////\r\n\r\n// () -> HTMLButtonElement\r\nfunction createCloseIcon() {\r\n  return d3.select(document.createElement('button'))\r\n      .attr({class: 'close', 'aria-label': 'Close'})\r\n      .html('<span aria-hidden=\"true\">&times;</span>')\r\n    .node();\r\n}\r\n\r\n// Show import outcome (success/failure) and error (if any)\r\n// ({status: HTMLElement, details: HTMLElement}, ?Error) -> void\r\nfunction showImportContentOutcome(containers, error) {\r\n  var statusContainer = d3.select(containers.status),\r\n      detailsContainer = d3.select(containers.details);\r\n  statusContainer.selectAll('[role=\"alert\"]').remove();\r\n  detailsContainer.selectAll('.alert').remove();\r\n  var status = statusContainer.append('span')\r\n      .attr({role: 'alert'})\r\n      .style({\r\n        position: 'absolute', left: 0, width: '40%', // center between left and button\r\n        top: '50%', transform: 'translateY(-60%)' // center vertically\r\n      });\r\n\r\n  // () -> string\r\n  function showErrorDetails() {\r\n    var details = detailsContainer.append('div')\r\n        .attr({role: 'alert', class: 'alert alert-danger'})\r\n        .style('margin-top', '1em');\r\n    details.append(createCloseIcon)\r\n        .attr('data-dismiss', 'alert')\r\n        .on('click', function () {\r\n          status.remove(); // dismiss details => also dismiss status\r\n        });\r\n    if (error instanceof format.YAMLException) {\r\n      details.append('h4').text('Not valid YAML'); // only \".alert h4\" has margin-top: 0\r\n      details.append('pre').text(error.message);\r\n    } else if (error instanceof format.InvalidDocumentError) {\r\n      details.append('span')\r\n          .text(error.message.replace(/\\.?$/, '.')); // add period if missing\r\n    } else {\r\n      details.append('h4').text('Unexpected error');\r\n      details.append('pre').text(String(error));\r\n      return 'Import failed';\r\n    }\r\n    return 'Not a valid document';\r\n  }\r\n\r\n  if (error) {\r\n    var statusSummary = showErrorDetails();\r\n    status.attr({class: 'text-danger'})\r\n        .html('<span class=\"glyphicon glyphicon-exclamation-sign\" aria-hidden=\"true\"></span> '\r\n                + statusSummary);\r\n  } else {\r\n    status.attr({class: 'text-success'})\r\n        .html('<span class=\"glyphicon glyphicon-ok\" aria-hidden=\"true\"></span> '\r\n                + 'Import succeeded')\r\n      .transition()\r\n        .delay(2500)\r\n        .duration(2000)\r\n        .style('opacity', 0)\r\n        .remove();\r\n  }\r\n}\r\n\r\n// returns true if import succeeded\r\nfunction importDocumentContents(opts, content) {\r\n  var containers = opts.containers,\r\n      importDocument = opts.importDocument;\r\n\r\n  var error = (function () {\r\n    try {\r\n      importDocument(format.parseDocument(content));\r\n    } catch (e) {\r\n      return e;\r\n    }\r\n  }());\r\n  showImportContentOutcome(containers, error);\r\n  return (error == null);\r\n}\r\n\r\nexports.init = init;\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/sharing/import-panel.js\n// module id = 48\n// module chunks = 1","'use strict';\r\n\r\n/* eslint-env browser */\r\nvar format = require('./format');\r\nvar createGist = require('./gist').createGist;\r\nvar Clipboard = require('clipboard');\r\nvar $ = require('jquery'); // for bootstrap tooltip\r\n\r\n// https://github.com/Modernizr/Modernizr/blob/master/feature-detects/a/download.js\r\nvar canUseDownloadAttribute =\r\n  !window.externalHost && 'download' in document.createElement('a');\r\n\r\n// can copy to clipboard programmatically?\r\nvar canUseCopyCommand = (function () {\r\n  try {\r\n    return document.queryCommandSupported('copy');\r\n  } catch (e) {\r\n    return false;\r\n  }\r\n}());\r\n\r\n// Add event handlers to select an HTMLInputElement's text on focus.\r\nfunction addSelectOnFocus(element) {\r\n  element.addEventListener('focus', function selectAll(e) {\r\n    e.target.select();\r\n  });\r\n  // Safari workaround\r\n  element.addEventListener('mouseup', function (e) {\r\n    e.preventDefault();\r\n  });\r\n}\r\n\r\n// Show a one-time tooltip.\r\n// NB. an existing title attribute overrides the tooltip options.\r\nfunction showTransientTooltip($element, options) {\r\n  $element.tooltip(options)\r\n    .tooltip('show')\r\n    .one('hidden.bs.tooltip', function () {\r\n      $element.tooltip('destroy');\r\n    });\r\n}\r\n\r\nfunction showCopiedTooltip(element) {\r\n  showTransientTooltip($(element), {title: 'Copied!', placement: 'bottom'});\r\n}\r\n\r\n\r\n///////////////////////\r\n// Share with GitHub //\r\n///////////////////////\r\n\r\n/**\r\n * Generate a new gist and display a shareable link.\r\n * @param  {HTMLElement} container  Container to use for displaying the link.\r\n * @param  {HTMLButtonElement} button\r\n * @param  {string} filename\r\n * @param  {string} contents  The file contents.\r\n * @return {Promise}          Cancellable promise to create the gist.\r\n */\r\nfunction generateGist(container, button, filename, contents) {\r\n  var oldButtonText = button.textContent;\r\n  button.textContent = 'Loading…';\r\n  button.disabled = true;\r\n\r\n  var payload = {\r\n    files: {},\r\n    description: 'Turing machine for http://turingmachine.io',\r\n    public: true\r\n  };\r\n  payload.files[filename] = {content: contents};\r\n\r\n  return createGist(payload).then(function (response) {\r\n    // Show link on success\r\n    var id = response.id;\r\n    showGeneratedGist(container, 'http://turingmachine.io/?import-gist=' + id);\r\n  }).catch(function (reason) {\r\n    // Alert error on failure\r\n    var message = (function () {\r\n      var xhr = reason.xhr;\r\n      try {\r\n        return 'Response from GitHub: “' + xhr.responseJSON.message + '”';\r\n      } catch (e) {\r\n        if (xhr.status > 0) {\r\n          return 'HTTP status code: ' + xhr.status + ' ' + xhr.statusText;\r\n        } else {\r\n          return 'GitHub could not be reached.\\nYour Internet connection may be offline.';\r\n        }\r\n      }\r\n    }());\r\n    alert('Could not create new gist.\\n\\n' + message);\r\n\r\n    button.disabled = false;\r\n    button.textContent = oldButtonText;\r\n  });\r\n}\r\n\r\nfunction showGeneratedGist(container, url) {\r\n  container.innerHTML =\r\n    '<input id=\"sharedPermalink\" type=\"url\" class=\"form-control\" readonly>' +\r\n    '<button type=\"button\" class=\"btn btn-default\" data-clipboard-target=\"#sharedPermalink\">' +\r\n    '<span class=\"glyphicon glyphicon-copy\" aria-hidden=\"true\"></span>' +\r\n    '</button>';\r\n  var urlInput = container.querySelector('input');\r\n  urlInput.value = url;\r\n  urlInput.size = url.length + 2;\r\n  addSelectOnFocus(urlInput);\r\n  urlInput.focus();\r\n}\r\n\r\nfunction createGenerateGistButton(container) {\r\n  container.innerHTML =\r\n  '<button type=\"button\" class=\"btn btn-default\">Create permalink</button>' +\r\n  '<p class=\"help-block\">This will create and link to a new' +\r\n    ' <a href=\"https://help.github.com/articles/creating-gists/#creating-an-anonymous-gist\"' +\r\n    ' target=\"_blank\">read-only</a> GitHub gist.' +\r\n  '</p>';\r\n  return container.querySelector('button');\r\n}\r\n\r\n\r\n///////////////////\r\n// Download file //\r\n///////////////////\r\n\r\n// Create a link button if canUseDownloadAttribute, otherwise a link with instructions.\r\nfunction createDownloadLink(filename, contents) {\r\n  var link = document.createElement('a');\r\n  link.href = 'data:text/x-yaml;charset=utf-8,' + encodeURIComponent(contents);\r\n  link.target = '_blank';\r\n  link.download = filename;\r\n\r\n  if (canUseDownloadAttribute) {\r\n    link.textContent = 'Download document';\r\n    link.className = 'btn btn-primary';\r\n    return link;\r\n  } else {\r\n    link.textContent = 'Right-click here and choose “Save target as…” or “Download Linked File As…”';\r\n    var p = document.createElement('p');\r\n    p.innerHTML = ', <br>then name the file to end with <code>.yaml</code>';\r\n    p.insertBefore(link, p.firstChild);\r\n    return p;\r\n  }\r\n}\r\n\r\n\r\n////////////\r\n// Common //\r\n////////////\r\n\r\nfunction init(args) {\r\n  var $dialog = args.$dialog,\r\n      getCurrentDocument = args.getCurrentDocument,\r\n      getIsSynced = args.getIsSynced,\r\n      gistContainer = args.gistContainer,\r\n      downloadContainer = args.downloadContainer,\r\n      textarea = args.textarea;\r\n\r\n  if (canUseDownloadAttribute) {\r\n    $dialog.addClass('download-attr');\r\n  }\r\n  if (!canUseCopyCommand) {\r\n    $dialog.addClass('no-copycommand');\r\n  }\r\n  gistContainer.className = 'form-group form-inline';\r\n  addSelectOnFocus(textarea);\r\n\r\n  function setupDialog() {\r\n    var doc = getCurrentDocument();\r\n    var filename = doc.name + '.yaml';\r\n    var contents = format.stringifyDocument(doc);\r\n    var gistPromise;\r\n\r\n    // warn about unsynced changes\r\n    var $alert;\r\n    if (!getIsSynced()) {\r\n      $alert = $(\r\n        '<div class=\"alert alert-warning\" role=\"alert\">' +\r\n        'The code editor has <strong>unsynced changes</strong> and might not correspond with the diagram.<br>' +\r\n        'Click <q>Load machine</q> to try to sync them. Otherwise, two sets of code will be exported.' +\r\n        '</div>'\r\n      ).prependTo($dialog.find('.modal-body'));\r\n    }\r\n\r\n    createGenerateGistButton(gistContainer).addEventListener('click', function (e) {\r\n      gistPromise = generateGist(gistContainer, e.target, filename, contents);\r\n    });\r\n\r\n    // \"Download document\" button link\r\n    downloadContainer.appendChild(createDownloadLink(filename, contents));\r\n    // <textarea> for document contents\r\n    textarea.value = contents;\r\n\r\n    var clipboard = new Clipboard('[data-clipboard-target]');\r\n    clipboard.on('success', function (e) {\r\n      showCopiedTooltip(e.trigger);\r\n      e.clearSelection();\r\n    });\r\n\r\n    // return cleanup function\r\n    return function () {\r\n      if (gistPromise) {\r\n        try { gistPromise.cancel(); } catch (e) {/* */}\r\n      }\r\n      if ($alert) { $alert.remove(); }\r\n      gistContainer.textContent = '';\r\n      downloadContainer.textContent = '';\r\n      textarea.value = '';\r\n      clipboard.destroy();\r\n    };\r\n  }\r\n\r\n  $dialog.on('show.bs.modal', function () {\r\n    var cleanup = setupDialog();\r\n    $dialog.one('hidden.bs.modal', cleanup);\r\n  });\r\n  $dialog.on('shown.bs.modal', function () {\r\n    // workaround \"Copy to clipboard\" .focus() scrolling down to <textarea>\r\n    // note: doesn't work when <textarea> is completely out of view\r\n    textarea.setSelectionRange(0,0);\r\n  });\r\n}\r\n\r\nexports.init = init;\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/sharing/export-panel.js\n// module id = 49\n// module chunks = 1","module.exports = Clipboard;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"Clipboard\"\n// module id = 50\n// module chunks = 1","'use strict';\n/**\n * Displays a table of keyboard shortcuts.\n */\n\nvar d3 = require('d3');\n\nfunction identity(x) { return x; }\n\n/**\n * Renders a table, using three layers of list nesting: tbody, tr, td.\n * @param  {[ [[HTML]] ]}     data\n * @param  {HTMLTableElement} table\n * @return {D3Selection}            D3 selection of the <tbody> elements\n */\nfunction renderTable(data, table) {\n  var tbody = d3.select(table).selectAll('tbody')\n      .data(data)\n    .enter().append('tbody');\n\n  var tr = tbody.selectAll('tr')\n      .data(identity)\n    .enter().append('tr');\n\n  tr.selectAll('td')\n      .data(identity)\n    .enter().append('td')\n      .html(identity);\n\n  return tbody;\n}\n\n\n// type Key = string;\n// type KeyList = [Key];\n\n// Key -> Key\nfunction abbreviateKey(key) {\n  switch (key) {\n    case 'Command': return 'Cmd';\n    case 'Option':  return 'Opt';\n    case 'Up':      return '↑';\n    case 'Down':    return '↓';\n    case 'Left':    return '←';\n    case 'Right':   return '→';\n    default:        return key;\n  }\n}\n\n// KeyList -> HTML\nfunction keylistToHTML(keys) {\n  return keys.map(function (key) {\n    return '<kbd>' + key + '</kbd>';\n  }).join('-');\n}\n\n// Commands -> String -> KeyList\nfunction createGetKeylist(commands) {\n  var platform = commands.platform;\n  // workaround: some ace keybindings for Mac use Alt instead of Option\n  var altToOption = platform !== 'mac' ? identity : function (key) {\n    return (key === 'Alt') ? 'Option' : key;\n  };\n\n  return function getKeylist(name) {\n    return commands.commands[name].bindKey[platform].split('-').map(altToOption);\n  };\n}\n\n\n// Fills a <table> with some default keyboard shortcuts.\nfunction main(commands, table) {\n  var getKeylist = createGetKeylist(commands);\n\n  return renderTable(entries.map(function (group) {\n    return group.map(function (d) {\n      return [\n        keylistToHTML(getKeylist(d.name).map(abbreviateKey)),\n        d.desc\n      ];\n    });\n  }), table);\n}\n\nvar entries = [\n  [\n    { name: 'save', desc: 'Load machine<br> <small>Save changes and load the machine.</small>' }\n  ], [\n    { name: 'togglecomment', desc: 'Toggle comment' },\n    { name: 'indent', desc: 'Indent selection' },\n    { name: 'outdent', desc: 'Unindent selection' }\n  ], [\n    { name: 'movelinesup', desc: 'Move line up' },\n    { name: 'movelinesdown', desc: 'Move line down' },\n    { name: 'duplicateSelection', desc: 'Duplicate line/selection' }\n  ], [\n    { name: 'selectMoreAfter', desc: 'Add next occurrence to selection<br> <small>Like a quick “find”. Useful for renaming things.</small>' },\n    { name: 'find', desc: 'Find' },\n    { name: 'replace', desc: 'Find and Replace' }\n  ]\n];\n\n\nexports.main = main;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/kbdshortcuts.js\n// module id = 51\n// module chunks = 1"],"sourceRoot":""}